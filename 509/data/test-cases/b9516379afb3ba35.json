{"uid":"b9516379afb3ba35","name":"Multiple edit Tasks: некорректный assigneeId статус 400 !!! тест должен упасть после исправления бага CCSS-31512 !!! ","fullName":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_assignees#test_multiple_edit_tasks_invalid_assignee_id","historyId":"87fa58ddd0747823b3bcde7380af17b7","time":{"start":1765881301260,"stop":1765881301862,"duration":602},"description":"\n    Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n    Ожидаем HTTP 400 и корректное сообщение об ошибке.\n    Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n    так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n    ","descriptionHtml":"<pre><code>Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\nОжидаем HTTP 400 и корректное сообщение об ошибке.\nБаг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\nтак как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"CreateTask\",\"meta\":{\"context\":\"MongoServerError\",\"message\":\"Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7fe3ff8692d0>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'main': ['6866309d85fb8d104544a620'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], ...}\nmake_task_in_main = <function make_task_in_main.<locals>._create_task at 0x7fe3ff6e0d60>\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    @allure.title(\"Multiple edit Tasks: некорректный assigneeId статус 400 !!! тест должен упасть после исправления бага CCSS-31512 !!! \")\n    def test_multiple_edit_tasks_invalid_assignee_id(owner_client, main_space, main_board, main_personal, make_task_in_main):\n        \"\"\"\n        Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n        Ожидаем HTTP 400 и корректное сообщение об ошибке.\n        Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n        так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n        \"\"\"\n        with allure.step(\"Готовим валидные данные и генерируем невалидный assigneeId\"):\n            valid_assignee = main_personal[\"member\"][0]\n>           valid_task = make_task_in_main({\"name\": \"Valid task\"})\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py:146: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nbody_overrides = {'name': 'Valid task'}\n\n    def _create_task(body_overrides: dict):\n        body = {\n            \"space_id\": main_space,\n            \"board\": main_board\n        }\n        # объединим остальные поля в create_task_endpoint через kwargs\n        resp = owner_client.post(**create_task_endpoint(**body, **body_overrides))\n>       assert resp.status_code == 200, resp.text\nE       AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"CreateTask\",\"meta\":{\"context\":\"MongoServerError\",\"message\":\"Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.\"}}}\nE       assert 400 == 200\nE        +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/conftest.py:126: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1765880286464,"stop":1765880286464,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1765880286465,"stop":1765880286465,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1765880286465,"stop":1765880286465,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1765880286465,"stop":1765880286465,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1765880286465,"stop":1765880287271,"duration":806},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1765880289429,"stop":1765880289725,"duration":296},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1765880289725,"stop":1765880290023,"duration":298},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1765880295287,"stop":1765880295563,"duration":276},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_personal","time":{"start":1765880327426,"stop":1765880329688,"duration":2262},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"make_task_in_main","time":{"start":1765881301259,"stop":1765881301259,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n    Ожидаем HTTP 400 и корректное сообщение об ошибке.\n    Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n    так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n    ","status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"CreateTask\",\"meta\":{\"context\":\"MongoServerError\",\"message\":\"Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7fe3ff8692d0>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'main': ['6866309d85fb8d104544a620'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], ...}\nmake_task_in_main = <function make_task_in_main.<locals>._create_task at 0x7fe3ff6e0d60>\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    @allure.title(\"Multiple edit Tasks: некорректный assigneeId статус 400 !!! тест должен упасть после исправления бага CCSS-31512 !!! \")\n    def test_multiple_edit_tasks_invalid_assignee_id(owner_client, main_space, main_board, main_personal, make_task_in_main):\n        \"\"\"\n        Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n        Ожидаем HTTP 400 и корректное сообщение об ошибке.\n        Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n        так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n        \"\"\"\n        with allure.step(\"Готовим валидные данные и генерируем невалидный assigneeId\"):\n            valid_assignee = main_personal[\"member\"][0]\n>           valid_task = make_task_in_main({\"name\": \"Valid task\"})\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py:146: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nbody_overrides = {'name': 'Valid task'}\n\n    def _create_task(body_overrides: dict):\n        body = {\n            \"space_id\": main_space,\n            \"board\": main_board\n        }\n        # объединим остальные поля в create_task_endpoint через kwargs\n        resp = owner_client.post(**create_task_endpoint(**body, **body_overrides))\n>       assert resp.status_code == 200, resp.text\nE       AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"CreateTask\",\"meta\":{\"context\":\"MongoServerError\",\"message\":\"Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.\"}}}\nE       assert 400 == 200\nE        +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/conftest.py:126: AssertionError","steps":[{"name":"Готовим валидные данные и генерируем невалидный assigneeId","time":{"start":1765881301260,"stop":1765881301861,"duration":601},"status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"CreateTask\",\"meta\":{\"context\":\"MongoServerError\",\"message\":\"Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py\", line 146, in test_multiple_edit_tasks_invalid_assignee_id\n    valid_task = make_task_in_main({\"name\": \"Valid task\"})\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/conftest.py\", line 126, in _create_task\n    assert resp.status_code == 200, resp.text\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"make_task_in_main::0","time":{"start":1765881301868,"stop":1765881301868,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"multiple_edit_tasks"},{"name":"tag","value":"backend"},{"name":"suite","value":"test_multiple_edit_tasks_assignees"},{"name":"host","value":"runnervm6qbrg"},{"name":"thread","value":"2637-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_assignees"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":3,"broken":0,"skipped":0,"passed":26,"unknown":0,"total":29},"items":[{"uid":"24cb01fab9a14aea","reportUrl":"https://vaizcom.github.io/autotests/508/#testresult/24cb01fab9a14aea","status":"passed","time":{"start":1765875039700,"stop":1765875040667,"duration":967}},{"uid":"bb89684b9eb9d17a","reportUrl":"https://vaizcom.github.io/autotests/507/#testresult/bb89684b9eb9d17a","status":"passed","time":{"start":1765810194034,"stop":1765810195022,"duration":988}},{"uid":"a01e7406ffad45da","reportUrl":"https://vaizcom.github.io/autotests/506/#testresult/a01e7406ffad45da","status":"passed","time":{"start":1765789615436,"stop":1765789616520,"duration":1084}},{"uid":"61acfc3088354f07","reportUrl":"https://vaizcom.github.io/autotests/505/#testresult/61acfc3088354f07","status":"passed","time":{"start":1765786577799,"stop":1765786578762,"duration":963}},{"uid":"204b8caf1895fadb","reportUrl":"https://vaizcom.github.io/autotests/504/#testresult/204b8caf1895fadb","status":"passed","time":{"start":1765553128369,"stop":1765553129565,"duration":1196}},{"uid":"fc1d09f7919965a","reportUrl":"https://vaizcom.github.io/autotests/503/#testresult/fc1d09f7919965a","status":"passed","time":{"start":1765551874200,"stop":1765551875448,"duration":1248}},{"uid":"5a4fad120bf731e2","reportUrl":"https://vaizcom.github.io/autotests/502/#testresult/5a4fad120bf731e2","status":"passed","time":{"start":1765550514236,"stop":1765550515429,"duration":1193}},{"uid":"7c8044df85d571d4","reportUrl":"https://vaizcom.github.io/autotests/501/#testresult/7c8044df85d571d4","status":"passed","time":{"start":1765544573489,"stop":1765544574441,"duration":952}},{"uid":"f08eb11051f4da38","reportUrl":"https://vaizcom.github.io/autotests/500/#testresult/f08eb11051f4da38","status":"passed","time":{"start":1765526384808,"stop":1765526385791,"duration":983}},{"uid":"4c31f8afe552136a","reportUrl":"https://vaizcom.github.io/autotests/499/#testresult/4c31f8afe552136a","status":"failed","statusDetails":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","time":{"start":1765458191448,"stop":1765458192442,"duration":994}},{"uid":"cfd52212b5c69991","reportUrl":"https://vaizcom.github.io/autotests/498/#testresult/cfd52212b5c69991","status":"passed","time":{"start":1765444443355,"stop":1765444444629,"duration":1274}},{"uid":"bf4acf303408321","reportUrl":"https://vaizcom.github.io/autotests/497/#testresult/bf4acf303408321","status":"passed","time":{"start":1765442555353,"stop":1765442556427,"duration":1074}},{"uid":"4ba3c37d8385e43","reportUrl":"https://vaizcom.github.io/autotests/496/#testresult/4ba3c37d8385e43","status":"passed","time":{"start":1765372968475,"stop":1765372972238,"duration":3763}},{"uid":"a1b20558cee2b195","reportUrl":"https://vaizcom.github.io/autotests/495/#testresult/a1b20558cee2b195","status":"passed","time":{"start":1765274548790,"stop":1765274550710,"duration":1920}},{"uid":"c75f91193d550e47","reportUrl":"https://vaizcom.github.io/autotests/494/#testresult/c75f91193d550e47","status":"passed","time":{"start":1765206720017,"stop":1765206721233,"duration":1216}},{"uid":"ed9b3deba81e2f60","reportUrl":"https://vaizcom.github.io/autotests/493/#testresult/ed9b3deba81e2f60","status":"passed","time":{"start":1765203579862,"stop":1765203581033,"duration":1171}},{"uid":"a9362c84884ae23a","reportUrl":"https://vaizcom.github.io/autotests/492/#testresult/a9362c84884ae23a","status":"passed","time":{"start":1765200722015,"stop":1765200723300,"duration":1285}},{"uid":"36312724b5284a34","reportUrl":"https://vaizcom.github.io/autotests/491/#testresult/36312724b5284a34","status":"passed","time":{"start":1765189302419,"stop":1765189303680,"duration":1261}},{"uid":"996ccc530525824","reportUrl":"https://vaizcom.github.io/autotests/490/#testresult/996ccc530525824","status":"passed","time":{"start":1765187966922,"stop":1765187968083,"duration":1161}},{"uid":"2a80e891244f18b2","reportUrl":"https://vaizcom.github.io/autotests/489/#testresult/2a80e891244f18b2","status":"passed","time":{"start":1764995162468,"stop":1764995163781,"duration":1313}}]},"tags":["backend"]},"source":"b9516379afb3ba35.json","parameterValues":[]}