{"uid":"582c6a219047cde7","name":"Создание Project-документа для роли owner","fullName":"tests.test_backend.document.access_doc.test_create_doc_access_by_roles#test_create_and_archive_project_doc_access_by_roles","historyId":"0d0a3e9396dfba82a041484969c56ee3","time":{"start":1768469431367,"stop":1768469431975,"duration":608},"status":"failed","statusMessage":"AssertionError: assert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"request = <FixtureRequest for <Function test_create_and_archive_project_doc_access_by_roles[owner]>>\nmain_project = '686672af85fb8d104544e798'\nmain_space = '6866309d85fb8d104544a61e', client_fixture = 'owner_client'\nexpected_status = 200\n\n    @allure.parent_suite(\"Document Service\")\n    @allure.suite(\"Access document\")\n    @pytest.mark.parametrize(\n        'client_fixture, expected_status',\n        [\n            ('owner_client', 200),\n            ('manager_client', 200),\n            ('member_client', 200),\n            ('guest_client', 403),\n        ],\n        ids=['owner', 'manager', 'member', 'guest'],\n    )\n    def test_create_and_archive_project_doc_access_by_roles(\n        request, main_project, main_space, client_fixture, expected_status\n    ):\n        api_client = request.getfixturevalue(client_fixture)\n        role = client_fixture.replace('_client', '')\n        current_date = datetime.now().strftime('%Y.%m.%d_%H:%M:%S')\n        title = f'{current_date} Project Doc'\n    \n        allure.dynamic.title(f'Создание Project-документа для роли {role}')\n    \n        with allure.step(f'{role} создаёт Project-документ, {expected_status}'):\n            resp = api_client.post(\n                **create_document_endpoint(kind='Project', kind_id=main_project, space_id=main_space, title=title)\n            )\n            assert resp.status_code == expected_status\n    \n            if expected_status == 200:\n                with allure.step('Созданный Project-документ содержит title'):\n                    assert resp.json()['payload']['document']['title'] == title\n                    doc_id = resp.json()['payload']['document']['_id']\n                with allure.step(f'Архивация Project-документа, {expected_status}'):\n                    archive_resp = api_client.post(**archive_document_endpoint(space_id=main_space, document_id=doc_id))\n>                   assert archive_resp.status_code == 200\nE                   assert 400 == 200\nE                    +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/document/access_doc/test_create_doc_access_by_roles.py:87: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1768469387918,"stop":1768469387919,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1768469387919,"stop":1768469387919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1768469387919,"stop":1768469387919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1768469387919,"stop":1768469387919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1768469387919,"stop":1768469388334,"duration":415},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1768469389917,"stop":1768469390150,"duration":233},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1768469390150,"stop":1768469390554,"duration":404},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_project","time":{"start":1768469390554,"stop":1768469390753,"duration":199},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: assert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"request = <FixtureRequest for <Function test_create_and_archive_project_doc_access_by_roles[owner]>>\nmain_project = '686672af85fb8d104544e798'\nmain_space = '6866309d85fb8d104544a61e', client_fixture = 'owner_client'\nexpected_status = 200\n\n    @allure.parent_suite(\"Document Service\")\n    @allure.suite(\"Access document\")\n    @pytest.mark.parametrize(\n        'client_fixture, expected_status',\n        [\n            ('owner_client', 200),\n            ('manager_client', 200),\n            ('member_client', 200),\n            ('guest_client', 403),\n        ],\n        ids=['owner', 'manager', 'member', 'guest'],\n    )\n    def test_create_and_archive_project_doc_access_by_roles(\n        request, main_project, main_space, client_fixture, expected_status\n    ):\n        api_client = request.getfixturevalue(client_fixture)\n        role = client_fixture.replace('_client', '')\n        current_date = datetime.now().strftime('%Y.%m.%d_%H:%M:%S')\n        title = f'{current_date} Project Doc'\n    \n        allure.dynamic.title(f'Создание Project-документа для роли {role}')\n    \n        with allure.step(f'{role} создаёт Project-документ, {expected_status}'):\n            resp = api_client.post(\n                **create_document_endpoint(kind='Project', kind_id=main_project, space_id=main_space, title=title)\n            )\n            assert resp.status_code == expected_status\n    \n            if expected_status == 200:\n                with allure.step('Созданный Project-документ содержит title'):\n                    assert resp.json()['payload']['document']['title'] == title\n                    doc_id = resp.json()['payload']['document']['_id']\n                with allure.step(f'Архивация Project-документа, {expected_status}'):\n                    archive_resp = api_client.post(**archive_document_endpoint(space_id=main_space, document_id=doc_id))\n>                   assert archive_resp.status_code == 200\nE                   assert 400 == 200\nE                    +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/document/access_doc/test_create_doc_access_by_roles.py:87: AssertionError","steps":[{"name":"owner создаёт Project-документ, 200","time":{"start":1768469431367,"stop":1768469431975,"duration":608},"status":"failed","statusMessage":"AssertionError: assert 400 == 200\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/document/access_doc/test_create_doc_access_by_roles.py\", line 87, in test_create_and_archive_project_doc_access_by_roles\n    assert archive_resp.status_code == 200\n","steps":[{"name":"Созданный Project-документ содержит title","time":{"start":1768469431705,"stop":1768469431706,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Архивация Project-документа, 200","time":{"start":1768469431706,"stop":1768469431974,"duration":268},"status":"failed","statusMessage":"AssertionError: assert 400 == 200\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/document/access_doc/test_create_doc_access_by_roles.py\", line 87, in test_create_and_archive_project_doc_access_by_roles\n    assert archive_resp.status_code == 200\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":3,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"Document Service"},{"name":"suite","value":"Access document"},{"name":"tag","value":"backend"},{"name":"host","value":"runnervmmtnos"},{"name":"thread","value":"2637-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.document.access_doc.test_create_doc_access_by_roles"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"client_fixture","value":"'owner_client'"},{"name":"expected_status","value":"200"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":5,"broken":0,"skipped":0,"passed":131,"unknown":0,"total":136},"items":[{"uid":"77a297d75d7f0e79","reportUrl":"https://vaizcom.github.io/autotests/535/#testresult/77a297d75d7f0e79","status":"passed","time":{"start":1768469417566,"stop":1768469418108,"duration":542}},{"uid":"372e574978b58bd1","reportUrl":"https://vaizcom.github.io/autotests/534/#testresult/372e574978b58bd1","status":"passed","time":{"start":1768467677343,"stop":1768467677852,"duration":509}},{"uid":"8c9b107e42c67d2a","reportUrl":"https://vaizcom.github.io/autotests/533/#testresult/8c9b107e42c67d2a","status":"passed","time":{"start":1768403394703,"stop":1768403395330,"duration":627}},{"uid":"6d03c22b89859e97","reportUrl":"https://vaizcom.github.io/autotests/532/#testresult/6d03c22b89859e97","status":"passed","time":{"start":1768316786016,"stop":1768316786612,"duration":596}},{"uid":"d1fad831cb67ad34","reportUrl":"https://vaizcom.github.io/autotests/531/#testresult/d1fad831cb67ad34","status":"passed","time":{"start":1768299437395,"stop":1768299437884,"duration":489}},{"uid":"bd6327f04d0bf26a","reportUrl":"https://vaizcom.github.io/autotests/530/#testresult/bd6327f04d0bf26a","status":"passed","time":{"start":1768298526117,"stop":1768298526661,"duration":544}},{"uid":"345fa69774795077","reportUrl":"https://vaizcom.github.io/autotests/529/#testresult/345fa69774795077","status":"passed","time":{"start":1767849672317,"stop":1767849672864,"duration":547}},{"uid":"9910cc9e060af92b","reportUrl":"https://vaizcom.github.io/autotests/528/#testresult/9910cc9e060af92b","status":"passed","time":{"start":1766507525989,"stop":1766507526578,"duration":589}},{"uid":"36c6d6088b629d09","reportUrl":"https://vaizcom.github.io/autotests/527/#testresult/36c6d6088b629d09","status":"passed","time":{"start":1766506184317,"stop":1766506184903,"duration":586}},{"uid":"bf9a4909d6acbb1a","reportUrl":"https://vaizcom.github.io/autotests/526/#testresult/bf9a4909d6acbb1a","status":"passed","time":{"start":1766505049025,"stop":1766505049625,"duration":600}},{"uid":"b2159162d785e948","reportUrl":"https://vaizcom.github.io/autotests/525/#testresult/b2159162d785e948","status":"passed","time":{"start":1766504022150,"stop":1766504022655,"duration":505}},{"uid":"67ea00cffb21b067","reportUrl":"https://vaizcom.github.io/autotests/524/#testresult/67ea00cffb21b067","status":"passed","time":{"start":1766502796061,"stop":1766502796548,"duration":487}},{"uid":"6f156d2aea144019","reportUrl":"https://vaizcom.github.io/autotests/523/#testresult/6f156d2aea144019","status":"passed","time":{"start":1766496934908,"stop":1766496935370,"duration":462}},{"uid":"838a03348cb47512","reportUrl":"https://vaizcom.github.io/autotests/522/#testresult/838a03348cb47512","status":"passed","time":{"start":1766488582911,"stop":1766488583386,"duration":475}},{"uid":"cd2a6a0fc482f193","reportUrl":"https://vaizcom.github.io/autotests/521/#testresult/cd2a6a0fc482f193","status":"passed","time":{"start":1766487101161,"stop":1766487101768,"duration":607}},{"uid":"b32ca0a7a26cc04a","reportUrl":"https://vaizcom.github.io/autotests/520/#testresult/b32ca0a7a26cc04a","status":"passed","time":{"start":1766412032698,"stop":1766412033247,"duration":549}},{"uid":"a8d435ea34ddde7","reportUrl":"https://vaizcom.github.io/autotests/519/#testresult/a8d435ea34ddde7","status":"passed","time":{"start":1766405989196,"stop":1766405989770,"duration":574}},{"uid":"3c63bf010da486db","reportUrl":"https://vaizcom.github.io/autotests/518/#testresult/3c63bf010da486db","status":"passed","time":{"start":1766403671260,"stop":1766403671778,"duration":518}},{"uid":"fa73af348c875d3f","reportUrl":"https://vaizcom.github.io/autotests/517/#testresult/fa73af348c875d3f","status":"passed","time":{"start":1766402238984,"stop":1766402239510,"duration":526}},{"uid":"5953fc756db6e510","reportUrl":"https://vaizcom.github.io/autotests/516/#testresult/5953fc756db6e510","status":"passed","time":{"start":1766067106678,"stop":1766067107317,"duration":639}}]},"tags":["backend"]},"source":"582c6a219047cde7.json","parameterValues":["'owner_client'","200"]}