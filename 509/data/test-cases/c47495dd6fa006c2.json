{"uid":"c47495dd6fa006c2","name":"Multiple edit Tasks: completed=True меняет только незавершённую таску, завершённая остаётся без изменений","fullName":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_completed#test_multiple_edit_tasks_sets_completed_only_uncompleted","historyId":"5ad67a5ca595a0258056436af4e9400f","time":{"start":1765881315176,"stop":1765881316186,"duration":1010},"status":"broken","statusMessage":"requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://vaiz-api-ms.vaiz.dev/v4/GetTask","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7fe3ff8692d0>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    def test_multiple_edit_tasks_sets_completed_only_uncompleted(owner_client, main_space, main_board):\n        allure.dynamic.title(\"Multiple edit Tasks: completed=True меняет только незавершённую таску, завершённая остаётся без изменений\")\n    \n        \"\"\"\n        Создаём 2 задачи:\n        - task_done: заранее ставим completed=True\n        - task_todo: оставляем completed=False\n        Применяем MultipleEditTasks с completed=True к обеим таскам.\n        Проверяем:\n        - в payload.success присутствуют task_todo и task_done\n        - состояния по get_task: task_done остался True, task_todo стал True\n        Удаляем созданные задачи.\n        \"\"\"\n    \n        t_true = None\n        t_false = None\n        try:\n            with allure.step(\"предусловие: Создаём 2 задачи  task_completed_true, task_completed_false\"):\n                _true = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=True, name=\"task_completed_true\"))\n                _false = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=False, name=\"task_completed_false\"))\n                t_true = (((_true.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n                t_false = (((_false.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n    \n            with allure.step(\"Проверяем предусловие корректно выставленных completed: используем для проверки get_task\"):\n                r_true = owner_client.post(**get_task_endpoint(space_id=main_space, slug_id=t_true))\n>               r_true.raise_for_status()\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_completed.py:93: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Response [400]>\n\n    def raise_for_status(self):\n        \"\"\"Raises :class:`HTTPError`, if one occurred.\"\"\"\n    \n        http_error_msg = \"\"\n        if isinstance(self.reason, bytes):\n            # We attempt to decode utf-8 first because some servers\n            # choose to localize their reason strings. If the string\n            # isn't utf-8, we fall back to iso-8859-1 for all other\n            # encodings. (See PR #3538)\n            try:\n                reason = self.reason.decode(\"utf-8\")\n            except UnicodeDecodeError:\n                reason = self.reason.decode(\"iso-8859-1\")\n        else:\n            reason = self.reason\n    \n        if 400 <= self.status_code < 500:\n            http_error_msg = (\n                f\"{self.status_code} Client Error: {reason} for url: {self.url}\"\n            )\n    \n        elif 500 <= self.status_code < 600:\n            http_error_msg = (\n                f\"{self.status_code} Server Error: {reason} for url: {self.url}\"\n            )\n    \n        if http_error_msg:\n>           raise HTTPError(http_error_msg, response=self)\nE           requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://vaiz-api-ms.vaiz.dev/v4/GetTask\n\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/requests/models.py:1024: HTTPError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1765880286464,"stop":1765880286464,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1765880286465,"stop":1765880286465,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1765880286465,"stop":1765880286465,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1765880286465,"stop":1765880286465,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1765880286465,"stop":1765880287271,"duration":806},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1765880289429,"stop":1765880289725,"duration":296},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1765880289725,"stop":1765880290023,"duration":298},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1765880295287,"stop":1765880295563,"duration":276},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://vaiz-api-ms.vaiz.dev/v4/GetTask","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7fe3ff8692d0>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    def test_multiple_edit_tasks_sets_completed_only_uncompleted(owner_client, main_space, main_board):\n        allure.dynamic.title(\"Multiple edit Tasks: completed=True меняет только незавершённую таску, завершённая остаётся без изменений\")\n    \n        \"\"\"\n        Создаём 2 задачи:\n        - task_done: заранее ставим completed=True\n        - task_todo: оставляем completed=False\n        Применяем MultipleEditTasks с completed=True к обеим таскам.\n        Проверяем:\n        - в payload.success присутствуют task_todo и task_done\n        - состояния по get_task: task_done остался True, task_todo стал True\n        Удаляем созданные задачи.\n        \"\"\"\n    \n        t_true = None\n        t_false = None\n        try:\n            with allure.step(\"предусловие: Создаём 2 задачи  task_completed_true, task_completed_false\"):\n                _true = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=True, name=\"task_completed_true\"))\n                _false = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=False, name=\"task_completed_false\"))\n                t_true = (((_true.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n                t_false = (((_false.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n    \n            with allure.step(\"Проверяем предусловие корректно выставленных completed: используем для проверки get_task\"):\n                r_true = owner_client.post(**get_task_endpoint(space_id=main_space, slug_id=t_true))\n>               r_true.raise_for_status()\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_completed.py:93: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Response [400]>\n\n    def raise_for_status(self):\n        \"\"\"Raises :class:`HTTPError`, if one occurred.\"\"\"\n    \n        http_error_msg = \"\"\n        if isinstance(self.reason, bytes):\n            # We attempt to decode utf-8 first because some servers\n            # choose to localize their reason strings. If the string\n            # isn't utf-8, we fall back to iso-8859-1 for all other\n            # encodings. (See PR #3538)\n            try:\n                reason = self.reason.decode(\"utf-8\")\n            except UnicodeDecodeError:\n                reason = self.reason.decode(\"iso-8859-1\")\n        else:\n            reason = self.reason\n    \n        if 400 <= self.status_code < 500:\n            http_error_msg = (\n                f\"{self.status_code} Client Error: {reason} for url: {self.url}\"\n            )\n    \n        elif 500 <= self.status_code < 600:\n            http_error_msg = (\n                f\"{self.status_code} Server Error: {reason} for url: {self.url}\"\n            )\n    \n        if http_error_msg:\n>           raise HTTPError(http_error_msg, response=self)\nE           requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://vaiz-api-ms.vaiz.dev/v4/GetTask\n\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/requests/models.py:1024: HTTPError","steps":[{"name":"предусловие: Создаём 2 задачи  task_completed_true, task_completed_false","time":{"start":1765881315176,"stop":1765881315904,"duration":728},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяем предусловие корректно выставленных completed: используем для проверки get_task","time":{"start":1765881315904,"stop":1765881316185,"duration":281},"status":"broken","statusMessage":"requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://vaiz-api-ms.vaiz.dev/v4/GetTask\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_completed.py\", line 93, in test_multiple_edit_tasks_sets_completed_only_uncompleted\n    r_true.raise_for_status()\n  File \"/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/requests/models.py\", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"multiple_edit_tasks"},{"name":"tag","value":"backend"},{"name":"suite","value":"test_multiple_edit_tasks_completed"},{"name":"host","value":"runnervm6qbrg"},{"name":"thread","value":"2637-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_completed"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":1,"broken":2,"skipped":0,"passed":27,"unknown":0,"total":30},"items":[{"uid":"980aac018a163384","reportUrl":"https://vaizcom.github.io/autotests/508/#testresult/980aac018a163384","status":"passed","time":{"start":1765875074717,"stop":1765875076554,"duration":1837}},{"uid":"85fb1d2b5b1895ca","reportUrl":"https://vaizcom.github.io/autotests/507/#testresult/85fb1d2b5b1895ca","status":"passed","time":{"start":1765810235581,"stop":1765810239778,"duration":4197}},{"uid":"9154a7029ab050a3","reportUrl":"https://vaizcom.github.io/autotests/506/#testresult/9154a7029ab050a3","status":"passed","time":{"start":1765789650538,"stop":1765789652643,"duration":2105}},{"uid":"1b53a47d32f7f25a","reportUrl":"https://vaizcom.github.io/autotests/505/#testresult/1b53a47d32f7f25a","status":"passed","time":{"start":1765786613341,"stop":1765786615484,"duration":2143}},{"uid":"7a259d9df29e715c","reportUrl":"https://vaizcom.github.io/autotests/504/#testresult/7a259d9df29e715c","status":"passed","time":{"start":1765553169451,"stop":1765553171877,"duration":2426}},{"uid":"81352e9561cfeba5","reportUrl":"https://vaizcom.github.io/autotests/503/#testresult/81352e9561cfeba5","status":"passed","time":{"start":1765551917000,"stop":1765551919368,"duration":2368}},{"uid":"63eb806b4119e68d","reportUrl":"https://vaizcom.github.io/autotests/502/#testresult/63eb806b4119e68d","status":"passed","time":{"start":1765550557255,"stop":1765550559622,"duration":2367}},{"uid":"279c754187c3451f","reportUrl":"https://vaizcom.github.io/autotests/501/#testresult/279c754187c3451f","status":"passed","time":{"start":1765544611537,"stop":1765544613511,"duration":1974}},{"uid":"6bf4fe863fa6fba4","reportUrl":"https://vaizcom.github.io/autotests/500/#testresult/6bf4fe863fa6fba4","status":"passed","time":{"start":1765526424244,"stop":1765526426824,"duration":2580}},{"uid":"d05cba682471b387","reportUrl":"https://vaizcom.github.io/autotests/499/#testresult/d05cba682471b387","status":"failed","statusDetails":"AssertionError: Ожидали 200, получили 400\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","time":{"start":1765458209729,"stop":1765458211341,"duration":1612}},{"uid":"caa7476f8fc36306","reportUrl":"https://vaizcom.github.io/autotests/498/#testresult/caa7476f8fc36306","status":"passed","time":{"start":1765444487390,"stop":1765444489864,"duration":2474}},{"uid":"584a84501711e712","reportUrl":"https://vaizcom.github.io/autotests/497/#testresult/584a84501711e712","status":"passed","time":{"start":1765442595365,"stop":1765442597818,"duration":2453}},{"uid":"130b1db0991bef63","reportUrl":"https://vaizcom.github.io/autotests/496/#testresult/130b1db0991bef63","status":"passed","time":{"start":1765373012562,"stop":1765373014999,"duration":2437}},{"uid":"e9d653362c125e09","reportUrl":"https://vaizcom.github.io/autotests/495/#testresult/e9d653362c125e09","status":"passed","time":{"start":1765274613805,"stop":1765274617687,"duration":3882}},{"uid":"d35b28f75556fae","reportUrl":"https://vaizcom.github.io/autotests/494/#testresult/d35b28f75556fae","status":"passed","time":{"start":1765206751606,"stop":1765206753680,"duration":2074}},{"uid":"51b23592fcfc2952","reportUrl":"https://vaizcom.github.io/autotests/493/#testresult/51b23592fcfc2952","status":"passed","time":{"start":1765203623426,"stop":1765203625640,"duration":2214}},{"uid":"c93278c31dacecc3","reportUrl":"https://vaizcom.github.io/autotests/492/#testresult/c93278c31dacecc3","status":"passed","time":{"start":1765200763619,"stop":1765200765766,"duration":2147}},{"uid":"75e02838f37fecaa","reportUrl":"https://vaizcom.github.io/autotests/491/#testresult/75e02838f37fecaa","status":"passed","time":{"start":1765189345586,"stop":1765189347930,"duration":2344}},{"uid":"eac1b571398b0d61","reportUrl":"https://vaizcom.github.io/autotests/490/#testresult/eac1b571398b0d61","status":"passed","time":{"start":1765188001724,"stop":1765188007724,"duration":6000}},{"uid":"d26240eadb280747","reportUrl":"https://vaizcom.github.io/autotests/489/#testresult/d26240eadb280747","status":"passed","time":{"start":1764995210273,"stop":1764995212395,"duration":2122}}]},"tags":["backend"]},"source":"c47495dd6fa006c2.json","parameterValues":[]}