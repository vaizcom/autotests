{"uid":"3ffbb181f9de3247","name":"Проверка сортировки задач по дате создания (по убыванию)","fullName":"tests.test_backend.task_service.get_tasks.task_criteria_desc.test_get_tasks_sorting_by_created_at_desc#test_get_tasks_sorting_by_created_at_desc","historyId":"416c795dd50610306bd49f1064a1e020","time":{"start":1762951013385,"stop":1762951018569,"duration":5184},"description":"ВРЕМЕННО РАЗМЕЩЕН ЗДЕСЬ из-за кэша на бэке (10 сек), для выполнения без влияния кэширования.\n     Когда проблема с кэшем будет решена или найдется другое решение,\n    тест можно будет вернуть в его изначальное место в get_tasks.\n\n    Проверяет что задачи возвращаются отсортированными по created_at в убывающем порядке (новые сверху)","descriptionHtml":"<p>ВРЕМЕННО РАЗМЕЩЕН ЗДЕСЬ из-за кэша на бэке (10 сек), для выполнения без влияния кэширования.<br />\nКогда проблема с кэшем будет решена или найдется другое решение,<br />\nтест можно будет вернуть в его изначальное место в get_tasks.</p>\n<pre><code>Проверяет что задачи возвращаются отсортированными по created_at в убывающем порядке (новые сверху)\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: Нарушена сортировка по убыванию: 2025-11-04 10:30:07.199000+00:00 должна быть >= 2025-11-04 10:30:07.463000+00:00\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 199000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal())","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f6d1fe3ac10>\nmain_space = '6866309d85fb8d104544a61e'\nboard_with_tasks = '6909d4141a593d8d7c3b9f91'\n\n    @allure.title(\"Проверка сортировки задач по дате создания (по убыванию)\")\n    def test_get_tasks_sorting_by_created_at_desc(owner_client, main_space, board_with_tasks):\n        \"\"\"ВРЕМЕННО РАЗМЕЩЕН ЗДЕСЬ из-за кэша на бэке (10 сек), для выполнения без влияния кэширования.\n         Когда проблема с кэшем будет решена или найдется другое решение,\n        тест можно будет вернуть в его изначальное место в get_tasks.\n    \n        Проверяет что задачи возвращаются отсортированными по created_at в убывающем порядке (новые сверху)\"\"\"\n    \n        with allure.step(\"Выполнить запрос с сортировкой по createdAt DESC\"):\n            resp = owner_client.post(**get_tasks_endpoint(\n                space_id=main_space,\n                board=board_with_tasks,\n                sortCriteria=\"createdAt\",\n                sortDirection=-1,\n    \n            ))\n    \n        with allure.step(\"Проверить HTTP 200\"):\n            assert resp.status_code == 200\n    \n        with allure.step(\"Проверить сортировку по убыванию (новые задачи сверху)\"):\n            tasks = resp.json()[\"payload\"][\"tasks\"]\n    \n            assert len(tasks) <= 50000, \"Количество задач не должно превышать лимит\"\n    \n            if len(tasks) > 1:\n                created_dates = [parser.parse(task[\"createdAt\"]) for task in tasks]\n    \n                # Проверяем сортировку по убыванию (каждая следующая дата <= предыдущей)\n                for i in range(len(created_dates) - 1):\n>                   assert created_dates[i] >= created_dates[i + 1], \\\n                        f\"Нарушена сортировка по убыванию: {created_dates[i]} должна быть >= {created_dates[i + 1]}\"\nE                   AssertionError: Нарушена сортировка по убыванию: 2025-11-04 10:30:07.199000+00:00 должна быть >= 2025-11-04 10:30:07.463000+00:00\nE                   assert datetime.datetime(2025, 11, 4, 10, 30, 7, 199000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal())\n\ntests/test_backend/task_service/get_tasks/task_criteria_desc/test_get_tasks_sorting_by_created_at_desc.py:40: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"description":"ВРЕМЕННО РАЗМЕЩЕН ЗДЕСЬ из-за кэша на бэке (10 сек), для выполнения без влияния кэширования.\n     Когда проблема с кэшем будет решена или найдется другое решение,\n    тест можно будет вернуть в его изначальное место в get_tasks.\n\n    Проверяет что задачи возвращаются отсортированными по created_at в убывающем порядке (новые сверху)","status":"failed","statusMessage":"AssertionError: Нарушена сортировка по убыванию: 2025-11-04 10:30:07.199000+00:00 должна быть >= 2025-11-04 10:30:07.463000+00:00\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 199000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal())","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f6d1fe3ac10>\nmain_space = '6866309d85fb8d104544a61e'\nboard_with_tasks = '6909d4141a593d8d7c3b9f91'\n\n    @allure.title(\"Проверка сортировки задач по дате создания (по убыванию)\")\n    def test_get_tasks_sorting_by_created_at_desc(owner_client, main_space, board_with_tasks):\n        \"\"\"ВРЕМЕННО РАЗМЕЩЕН ЗДЕСЬ из-за кэша на бэке (10 сек), для выполнения без влияния кэширования.\n         Когда проблема с кэшем будет решена или найдется другое решение,\n        тест можно будет вернуть в его изначальное место в get_tasks.\n    \n        Проверяет что задачи возвращаются отсортированными по created_at в убывающем порядке (новые сверху)\"\"\"\n    \n        with allure.step(\"Выполнить запрос с сортировкой по createdAt DESC\"):\n            resp = owner_client.post(**get_tasks_endpoint(\n                space_id=main_space,\n                board=board_with_tasks,\n                sortCriteria=\"createdAt\",\n                sortDirection=-1,\n    \n            ))\n    \n        with allure.step(\"Проверить HTTP 200\"):\n            assert resp.status_code == 200\n    \n        with allure.step(\"Проверить сортировку по убыванию (новые задачи сверху)\"):\n            tasks = resp.json()[\"payload\"][\"tasks\"]\n    \n            assert len(tasks) <= 50000, \"Количество задач не должно превышать лимит\"\n    \n            if len(tasks) > 1:\n                created_dates = [parser.parse(task[\"createdAt\"]) for task in tasks]\n    \n                # Проверяем сортировку по убыванию (каждая следующая дата <= предыдущей)\n                for i in range(len(created_dates) - 1):\n>                   assert created_dates[i] >= created_dates[i + 1], \\\n                        f\"Нарушена сортировка по убыванию: {created_dates[i]} должна быть >= {created_dates[i + 1]}\"\nE                   AssertionError: Нарушена сортировка по убыванию: 2025-11-04 10:30:07.199000+00:00 должна быть >= 2025-11-04 10:30:07.463000+00:00\nE                   assert datetime.datetime(2025, 11, 4, 10, 30, 7, 199000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal())\n\ntests/test_backend/task_service/get_tasks/task_criteria_desc/test_get_tasks_sorting_by_created_at_desc.py:40: AssertionError","steps":[{"name":"Выполнить запрос с сортировкой по createdAt DESC","time":{"start":1762951013385,"stop":1762951017936,"duration":4551},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверить HTTP 200","time":{"start":1762951017936,"stop":1762951017936,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверить сортировку по убыванию (новые задачи сверху)","time":{"start":1762951017936,"stop":1762951018568,"duration":632},"status":"failed","statusMessage":"AssertionError: Нарушена сортировка по убыванию: 2025-11-04 10:30:07.199000+00:00 должна быть >= 2025-11-04 10:30:07.463000+00:00\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 199000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal())\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/get_tasks/task_criteria_desc/test_get_tasks_sorting_by_created_at_desc.py\", line 40, in test_get_tasks_sorting_by_created_at_desc\n    assert created_dates[i] >= created_dates[i + 1], \\\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":3,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"tag","value":"backend"},{"name":"parentSuite","value":"tests.test_backend.task_service.get_tasks.task_criteria_desc"},{"name":"suite","value":"test_get_tasks_sorting_by_created_at_desc"},{"name":"host","value":"runnervmw9dnm"},{"name":"thread","value":"2577-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.get_tasks.task_criteria_desc.test_get_tasks_sorting_by_created_at_desc"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["backend"]},"source":"3ffbb181f9de3247.json","parameterValues":[]}