{"uid":"67d1bfa0ba69d3fa","name":"Проверяем siblins для нескольких корневых документов (kind=Project)","fullName":"tests.test_backend.document.test_get_siblings#test_root_level_siblings","historyId":"e2bacd7cfa82350b9fc589de33930fd9","time":{"start":1765544076476,"stop":1765544078272,"duration":1796},"description":"\n    Проверяем сиблинги для нескольких корневых документов (без parent_document_id).\n    ","descriptionHtml":"<pre><code>Проверяем сиблинги для нескольких корневых документов (без parent_document_id).\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: assert 401 == 200\n +  where 401 = <Response [401]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f377c51f890>\nrequest = <FixtureRequest for <Function test_root_level_siblings[project]>>\nkind = 'Project', kind_id_fixture = 'project_id_function'\nspace_id_function = '693c108c3e3b6c1272481344'\n\n    @allure.feature('Document Siblings')\n    @pytest.mark.parametrize(\n        'kind, kind_id_fixture',\n        [\n            ('Project', 'project_id_function'),\n            ('Space', 'space_id_function'),\n            ('Member', 'member_id_function'),\n        ],\n        ids=['project', 'space', 'member'],\n    )\n    def test_root_level_siblings(owner_client, request, kind, kind_id_fixture, space_id_function):\n        \"\"\"\n        Проверяем сиблинги для нескольких корневых документов (без parent_document_id).\n        \"\"\"\n        allure.dynamic.title(f'Проверяем siblins для нескольких корневых документов (kind={kind})')\n        kind_id = request.getfixturevalue(kind_id_fixture)\n        titles = ['Root A', 'Root B', 'Root C']\n        doc_ids = []\n    \n        with allure.step('Создаем корневые документы'):\n            for title in titles:\n                resp = owner_client.post(\n                    **create_document_endpoint(kind=kind, kind_id=kind_id, space_id=space_id_function, title=title)\n                )\n                assert resp.status_code == 200, f'Не удалось создать документ {title}: {resp.text}'\n                doc_ids.append(resp.json()['payload']['document']['_id'])\n    \n        with allure.step('Проверка сиблингов для первого документа'):\n            resp1 = owner_client.post(**get_document_siblings_endpoint(document_id=doc_ids[0], space_id=space_id_function))\n            assert resp1.status_code == 200\n            p1 = resp1.json()['payload']\n            assert 'prevSibling' not in p1 or p1.get('prevSibling') is None\n            assert p1['nextSibling']['_id'] == doc_ids[1]\n            assert p1['parents'] == []\n    \n        with allure.step('Проверка сиблингов для среднего документа'):\n            resp2 = owner_client.post(**get_document_siblings_endpoint(document_id=doc_ids[1], space_id=space_id_function))\n>           assert resp2.status_code == 200\nE           assert 401 == 200\nE            +  where 401 = <Response [401]>.status_code\n\ntests/test_backend/document/test_get_siblings.py:94: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1765543768222,"stop":1765543768222,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1765543768222,"stop":1765543768670,"duration":448},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1765543768222,"stop":1765543768222,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1765543768222,"stop":1765543768222,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1765543768222,"stop":1765543768222,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"space_id_function","time":{"start":1765544076054,"stop":1765544076475,"duration":421},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_id_function","time":{"start":1765544076476,"stop":1765544076993,"duration":517},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Проверяем сиблинги для нескольких корневых документов (без parent_document_id).\n    ","status":"failed","statusMessage":"AssertionError: assert 401 == 200\n +  where 401 = <Response [401]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f377c51f890>\nrequest = <FixtureRequest for <Function test_root_level_siblings[project]>>\nkind = 'Project', kind_id_fixture = 'project_id_function'\nspace_id_function = '693c108c3e3b6c1272481344'\n\n    @allure.feature('Document Siblings')\n    @pytest.mark.parametrize(\n        'kind, kind_id_fixture',\n        [\n            ('Project', 'project_id_function'),\n            ('Space', 'space_id_function'),\n            ('Member', 'member_id_function'),\n        ],\n        ids=['project', 'space', 'member'],\n    )\n    def test_root_level_siblings(owner_client, request, kind, kind_id_fixture, space_id_function):\n        \"\"\"\n        Проверяем сиблинги для нескольких корневых документов (без parent_document_id).\n        \"\"\"\n        allure.dynamic.title(f'Проверяем siblins для нескольких корневых документов (kind={kind})')\n        kind_id = request.getfixturevalue(kind_id_fixture)\n        titles = ['Root A', 'Root B', 'Root C']\n        doc_ids = []\n    \n        with allure.step('Создаем корневые документы'):\n            for title in titles:\n                resp = owner_client.post(\n                    **create_document_endpoint(kind=kind, kind_id=kind_id, space_id=space_id_function, title=title)\n                )\n                assert resp.status_code == 200, f'Не удалось создать документ {title}: {resp.text}'\n                doc_ids.append(resp.json()['payload']['document']['_id'])\n    \n        with allure.step('Проверка сиблингов для первого документа'):\n            resp1 = owner_client.post(**get_document_siblings_endpoint(document_id=doc_ids[0], space_id=space_id_function))\n            assert resp1.status_code == 200\n            p1 = resp1.json()['payload']\n            assert 'prevSibling' not in p1 or p1.get('prevSibling') is None\n            assert p1['nextSibling']['_id'] == doc_ids[1]\n            assert p1['parents'] == []\n    \n        with allure.step('Проверка сиблингов для среднего документа'):\n            resp2 = owner_client.post(**get_document_siblings_endpoint(document_id=doc_ids[1], space_id=space_id_function))\n>           assert resp2.status_code == 200\nE           assert 401 == 200\nE            +  where 401 = <Response [401]>.status_code\n\ntests/test_backend/document/test_get_siblings.py:94: AssertionError","steps":[{"name":"Создаем корневые документы","time":{"start":1765544076993,"stop":1765544077859,"duration":866},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка сиблингов для первого документа","time":{"start":1765544077859,"stop":1765544078098,"duration":239},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка сиблингов для среднего документа","time":{"start":1765544078098,"stop":1765544078272,"duration":174},"status":"failed","statusMessage":"AssertionError: assert 401 == 200\n +  where 401 = <Response [401]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/document/test_get_siblings.py\", line 94, in test_root_level_siblings\n    assert resp2.status_code == 200\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":3,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"project_id_function::0","time":{"start":1765544078280,"stop":1765544078280,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"space_id_function::0","time":{"start":1765544078281,"stop":1765544078428,"duration":147},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"feature","value":"Document Siblings"},{"name":"tag","value":"backend"},{"name":"parentSuite","value":"tests.test_backend.document"},{"name":"suite","value":"test_get_siblings"},{"name":"host","value":"runnervm6qbrg"},{"name":"thread","value":"2657-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.document.test_get_siblings"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"kind","value":"'Project'"},{"name":"kind_id_fixture","value":"'project_id_function'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":6,"broken":0,"skipped":0,"passed":91,"unknown":0,"total":97},"items":[{"uid":"fd7f219f8ece5221","reportUrl":"https://vaizcom.github.io/autotests/500/#testresult/fd7f219f8ece5221","status":"passed","time":{"start":1765525910244,"stop":1765525915257,"duration":5013}},{"uid":"40ed048bae8ef741","reportUrl":"https://vaizcom.github.io/autotests/499/#testresult/40ed048bae8ef741","status":"passed","time":{"start":1765457674665,"stop":1765457676607,"duration":1942}},{"uid":"ffd6caf0b4c13202","reportUrl":"https://vaizcom.github.io/autotests/498/#testresult/ffd6caf0b4c13202","status":"passed","time":{"start":1765443887806,"stop":1765443890116,"duration":2310}},{"uid":"d67c14d35fe646a5","reportUrl":"https://vaizcom.github.io/autotests/497/#testresult/d67c14d35fe646a5","status":"passed","time":{"start":1765441972424,"stop":1765441974855,"duration":2431}},{"uid":"9d22c6e36e1caf6","reportUrl":"https://vaizcom.github.io/autotests/496/#testresult/9d22c6e36e1caf6","status":"passed","time":{"start":1765372438570,"stop":1765372440928,"duration":2358}},{"uid":"395f8096af5eb887","reportUrl":"https://vaizcom.github.io/autotests/495/#testresult/395f8096af5eb887","status":"passed","time":{"start":1765273756738,"stop":1765273762882,"duration":6144}},{"uid":"53a731058c9678f8","reportUrl":"https://vaizcom.github.io/autotests/494/#testresult/53a731058c9678f8","status":"passed","time":{"start":1765206219999,"stop":1765206221911,"duration":1912}},{"uid":"d84d44ab236de894","reportUrl":"https://vaizcom.github.io/autotests/493/#testresult/d84d44ab236de894","status":"passed","time":{"start":1765203126709,"stop":1765203128806,"duration":2097}},{"uid":"342e5a0ff805e55e","reportUrl":"https://vaizcom.github.io/autotests/492/#testresult/342e5a0ff805e55e","status":"passed","time":{"start":1765200226773,"stop":1765200229591,"duration":2818}},{"uid":"3c55bd44bf72d893","reportUrl":"https://vaizcom.github.io/autotests/491/#testresult/3c55bd44bf72d893","status":"passed","time":{"start":1765188839007,"stop":1765188841223,"duration":2216}},{"uid":"97af24af1a0f2ae8","reportUrl":"https://vaizcom.github.io/autotests/490/#testresult/97af24af1a0f2ae8","status":"passed","time":{"start":1765187501690,"stop":1765187503652,"duration":1962}},{"uid":"96ea06d5be71cc60","reportUrl":"https://vaizcom.github.io/autotests/489/#testresult/96ea06d5be71cc60","status":"passed","time":{"start":1764994701943,"stop":1764994703944,"duration":2001}},{"uid":"232739cecd73cb72","reportUrl":"https://vaizcom.github.io/autotests/488/#testresult/232739cecd73cb72","status":"passed","time":{"start":1764855748707,"stop":1764855750529,"duration":1822}},{"uid":"50b5e61ad0827db4","reportUrl":"https://vaizcom.github.io/autotests/487/#testresult/50b5e61ad0827db4","status":"passed","time":{"start":1764851099660,"stop":1764851101769,"duration":2109}},{"uid":"5ae87b7eb4d7d596","reportUrl":"https://vaizcom.github.io/autotests/486/#testresult/5ae87b7eb4d7d596","status":"passed","time":{"start":1764848324830,"stop":1764848326912,"duration":2082}},{"uid":"dfd681030b4adb93","reportUrl":"https://vaizcom.github.io/autotests/485/#testresult/dfd681030b4adb93","status":"passed","time":{"start":1764766364412,"stop":1764766366494,"duration":2082}},{"uid":"4ddd9d0c0fca9daa","reportUrl":"https://vaizcom.github.io/autotests/484/#testresult/4ddd9d0c0fca9daa","status":"passed","time":{"start":1764764954048,"stop":1764764956164,"duration":2116}},{"uid":"c2e0e988f1b46a03","reportUrl":"https://vaizcom.github.io/autotests/483/#testresult/c2e0e988f1b46a03","status":"passed","time":{"start":1764748704217,"stop":1764748706363,"duration":2146}},{"uid":"6b7870c4b5bb00ae","reportUrl":"https://vaizcom.github.io/autotests/482/#testresult/6b7870c4b5bb00ae","status":"passed","time":{"start":1764686885434,"stop":1764686887261,"duration":1827}},{"uid":"d442ad8bb27d1b3e","reportUrl":"https://vaizcom.github.io/autotests/481/#testresult/d442ad8bb27d1b3e","status":"passed","time":{"start":1764679849310,"stop":1764679851457,"duration":2147}}]},"tags":["backend"]},"source":"67d1bfa0ba69d3fa.json","parameterValues":["'Project'","'project_id_function'"]}