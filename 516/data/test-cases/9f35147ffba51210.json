{"uid":"9f35147ffba51210","name":"Multiple edit Tasks: completed=True меняет только незавершённую таску, завершённая остаётся без изменений","fullName":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_completed#test_multiple_edit_tasks_sets_completed_only_uncompleted","historyId":"5ad67a5ca595a0258056436af4e9400f","time":{"start":1766067970862,"stop":1766067972753,"duration":1891},"status":"failed","statusMessage":"AssertionError: Ожидали 200, получили 502\nassert 502 == 200\n +  where 502 = <Response [502]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7fce07c94850>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    def test_multiple_edit_tasks_sets_completed_only_uncompleted(owner_client, main_space, main_board):\n        allure.dynamic.title(\"Multiple edit Tasks: completed=True меняет только незавершённую таску, завершённая остаётся без изменений\")\n    \n        \"\"\"\n        Создаём 2 задачи:\n        - task_done: заранее ставим completed=True\n        - task_todo: оставляем completed=False\n        Применяем MultipleEditTasks с completed=True к обеим таскам.\n        Проверяем:\n        - в payload.success присутствуют task_todo и task_done\n        - состояния по get_task: task_done остался True, task_todo стал True\n        Удаляем созданные задачи.\n        \"\"\"\n    \n        t_true = None\n        t_false = None\n        try:\n            with allure.step(\"предусловие: Создаём 2 задачи  task_completed_true, task_completed_false\"):\n                _true = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=True, name=\"task_completed_true\"))\n                _false = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=False, name=\"task_completed_false\"))\n                t_true = (((_true.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n                t_false = (((_false.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n    \n            with allure.step(\"Проверяем предусловие корректно выставленных completed: используем для проверки get_task\"):\n                r_true = owner_client.post(**get_task_endpoint(space_id=main_space, slug_id=t_true))\n                r_true.raise_for_status()\n                t_true_body = ((r_true.json().get(\"payload\") or {}).get(\"task\")) or {}\n                assert t_true_body.get(\n                    \"completed\") is True, f\"task_done должен быть completed=True, получено {t_true_body.get('completed')!r}\"\n    \n                r_false = owner_client.post(**get_task_endpoint(space_id=main_space, slug_id=t_false))\n                r_false.raise_for_status()\n                r_false_body = ((r_false.json().get(\"payload\") or {}).get(\"task\")) or {}\n                assert r_false_body.get(\n                    \"completed\") is False, f\"task_todo должен быть не завершён, получено {r_false_body.get('completed')!r}\"\n    \n            with allure.step(\"Применяем completed=True к обеим задачам через MultipleEditTasks\"):\n                payload = [\n                    {\"taskId\": t_true, \"completed\": True},\n                    {\"taskId\": t_false, \"completed\": True},\n                ]\n                resp = owner_client.post(**multiple_edit_tasks_endpoint(space_id=main_space, tasks=payload))\n>               assert resp.status_code == 200, f\"Ожидали 200, получили {resp.status_code}\"\nE               AssertionError: Ожидали 200, получили 502\nE               assert 502 == 200\nE                +  where 502 = <Response [502]>.status_code\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_completed.py:110: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"pytestconfig","time":{"start":1766067056220,"stop":1766067056221,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1766067056220,"stop":1766067056220,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1766067056220,"stop":1766067056220,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1766067056221,"stop":1766067056679,"duration":458},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1766067056221,"stop":1766067056221,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1766067060230,"stop":1766067060525,"duration":295},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1766067060525,"stop":1766067060769,"duration":244},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1766067065280,"stop":1766067065509,"duration":229},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Ожидали 200, получили 502\nassert 502 == 200\n +  where 502 = <Response [502]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7fce07c94850>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    def test_multiple_edit_tasks_sets_completed_only_uncompleted(owner_client, main_space, main_board):\n        allure.dynamic.title(\"Multiple edit Tasks: completed=True меняет только незавершённую таску, завершённая остаётся без изменений\")\n    \n        \"\"\"\n        Создаём 2 задачи:\n        - task_done: заранее ставим completed=True\n        - task_todo: оставляем completed=False\n        Применяем MultipleEditTasks с completed=True к обеим таскам.\n        Проверяем:\n        - в payload.success присутствуют task_todo и task_done\n        - состояния по get_task: task_done остался True, task_todo стал True\n        Удаляем созданные задачи.\n        \"\"\"\n    \n        t_true = None\n        t_false = None\n        try:\n            with allure.step(\"предусловие: Создаём 2 задачи  task_completed_true, task_completed_false\"):\n                _true = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=True, name=\"task_completed_true\"))\n                _false = owner_client.post(\n                    **create_task_endpoint(main_space, board=main_board, completed=False, name=\"task_completed_false\"))\n                t_true = (((_true.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n                t_false = (((_false.json().get(\"payload\") or {}).get(\"task\")) or {}).get(\"_id\")\n    \n            with allure.step(\"Проверяем предусловие корректно выставленных completed: используем для проверки get_task\"):\n                r_true = owner_client.post(**get_task_endpoint(space_id=main_space, slug_id=t_true))\n                r_true.raise_for_status()\n                t_true_body = ((r_true.json().get(\"payload\") or {}).get(\"task\")) or {}\n                assert t_true_body.get(\n                    \"completed\") is True, f\"task_done должен быть completed=True, получено {t_true_body.get('completed')!r}\"\n    \n                r_false = owner_client.post(**get_task_endpoint(space_id=main_space, slug_id=t_false))\n                r_false.raise_for_status()\n                r_false_body = ((r_false.json().get(\"payload\") or {}).get(\"task\")) or {}\n                assert r_false_body.get(\n                    \"completed\") is False, f\"task_todo должен быть не завершён, получено {r_false_body.get('completed')!r}\"\n    \n            with allure.step(\"Применяем completed=True к обеим задачам через MultipleEditTasks\"):\n                payload = [\n                    {\"taskId\": t_true, \"completed\": True},\n                    {\"taskId\": t_false, \"completed\": True},\n                ]\n                resp = owner_client.post(**multiple_edit_tasks_endpoint(space_id=main_space, tasks=payload))\n>               assert resp.status_code == 200, f\"Ожидали 200, получили {resp.status_code}\"\nE               AssertionError: Ожидали 200, получили 502\nE               assert 502 == 200\nE                +  where 502 = <Response [502]>.status_code\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_completed.py:110: AssertionError","steps":[{"name":"предусловие: Создаём 2 задачи  task_completed_true, task_completed_false","time":{"start":1766067970862,"stop":1766067971536,"duration":674},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяем предусловие корректно выставленных completed: используем для проверки get_task","time":{"start":1766067971536,"stop":1766067972003,"duration":467},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Применяем completed=True к обеим задачам через MultipleEditTasks","time":{"start":1766067972003,"stop":1766067972629,"duration":626},"status":"failed","statusMessage":"AssertionError: Ожидали 200, получили 502\nassert 502 == 200\n +  where 502 = <Response [502]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_completed.py\", line 110, in test_multiple_edit_tasks_sets_completed_only_uncompleted\n    assert resp.status_code == 200, f\"Ожидали 200, получили {resp.status_code}\"\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":3,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"multiple_edit_tasks"},{"name":"tag","value":"backend"},{"name":"suite","value":"test_multiple_edit_tasks_completed"},{"name":"host","value":"runnervmh13bl"},{"name":"thread","value":"2659-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_completed"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":2,"skipped":0,"passed":33,"unknown":0,"total":37},"items":[{"uid":"fd38f838b8a15b7d","reportUrl":"https://vaizcom.github.io/autotests/515/#testresult/fd38f838b8a15b7d","status":"passed","time":{"start":1766043363425,"stop":1766043365600,"duration":2175}},{"uid":"f91a91dc4eeb12e5","reportUrl":"https://vaizcom.github.io/autotests/514/#testresult/f91a91dc4eeb12e5","status":"passed","time":{"start":1765984867621,"stop":1765984870329,"duration":2708}},{"uid":"4b1e5dcdc8d4a4ff","reportUrl":"https://vaizcom.github.io/autotests/513/#testresult/4b1e5dcdc8d4a4ff","status":"passed","time":{"start":1765976147456,"stop":1765976149608,"duration":2152}},{"uid":"a8a9ca40704e8c06","reportUrl":"https://vaizcom.github.io/autotests/512/#testresult/a8a9ca40704e8c06","status":"passed","time":{"start":1765892350550,"stop":1765892355040,"duration":4490}},{"uid":"f822d0fb5e2e0026","reportUrl":"https://vaizcom.github.io/autotests/511/#testresult/f822d0fb5e2e0026","status":"passed","time":{"start":1765890517688,"stop":1765890519830,"duration":2142}},{"uid":"56a278b441639852","reportUrl":"https://vaizcom.github.io/autotests/510/#testresult/56a278b441639852","status":"passed","time":{"start":1765881653484,"stop":1765881655568,"duration":2084}},{"uid":"c47495dd6fa006c2","reportUrl":"https://vaizcom.github.io/autotests/509/#testresult/c47495dd6fa006c2","status":"broken","statusDetails":"requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://vaiz-api-ms.vaiz.dev/v4/GetTask","time":{"start":1765881315176,"stop":1765881316186,"duration":1010}},{"uid":"980aac018a163384","reportUrl":"https://vaizcom.github.io/autotests/508/#testresult/980aac018a163384","status":"passed","time":{"start":1765875074717,"stop":1765875076554,"duration":1837}},{"uid":"85fb1d2b5b1895ca","reportUrl":"https://vaizcom.github.io/autotests/507/#testresult/85fb1d2b5b1895ca","status":"passed","time":{"start":1765810235581,"stop":1765810239778,"duration":4197}},{"uid":"9154a7029ab050a3","reportUrl":"https://vaizcom.github.io/autotests/506/#testresult/9154a7029ab050a3","status":"passed","time":{"start":1765789650538,"stop":1765789652643,"duration":2105}},{"uid":"1b53a47d32f7f25a","reportUrl":"https://vaizcom.github.io/autotests/505/#testresult/1b53a47d32f7f25a","status":"passed","time":{"start":1765786613341,"stop":1765786615484,"duration":2143}},{"uid":"7a259d9df29e715c","reportUrl":"https://vaizcom.github.io/autotests/504/#testresult/7a259d9df29e715c","status":"passed","time":{"start":1765553169451,"stop":1765553171877,"duration":2426}},{"uid":"81352e9561cfeba5","reportUrl":"https://vaizcom.github.io/autotests/503/#testresult/81352e9561cfeba5","status":"passed","time":{"start":1765551917000,"stop":1765551919368,"duration":2368}},{"uid":"63eb806b4119e68d","reportUrl":"https://vaizcom.github.io/autotests/502/#testresult/63eb806b4119e68d","status":"passed","time":{"start":1765550557255,"stop":1765550559622,"duration":2367}},{"uid":"279c754187c3451f","reportUrl":"https://vaizcom.github.io/autotests/501/#testresult/279c754187c3451f","status":"passed","time":{"start":1765544611537,"stop":1765544613511,"duration":1974}},{"uid":"6bf4fe863fa6fba4","reportUrl":"https://vaizcom.github.io/autotests/500/#testresult/6bf4fe863fa6fba4","status":"passed","time":{"start":1765526424244,"stop":1765526426824,"duration":2580}},{"uid":"d05cba682471b387","reportUrl":"https://vaizcom.github.io/autotests/499/#testresult/d05cba682471b387","status":"failed","statusDetails":"AssertionError: Ожидали 200, получили 400\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","time":{"start":1765458209729,"stop":1765458211341,"duration":1612}},{"uid":"caa7476f8fc36306","reportUrl":"https://vaizcom.github.io/autotests/498/#testresult/caa7476f8fc36306","status":"passed","time":{"start":1765444487390,"stop":1765444489864,"duration":2474}},{"uid":"584a84501711e712","reportUrl":"https://vaizcom.github.io/autotests/497/#testresult/584a84501711e712","status":"passed","time":{"start":1765442595365,"stop":1765442597818,"duration":2453}},{"uid":"130b1db0991bef63","reportUrl":"https://vaizcom.github.io/autotests/496/#testresult/130b1db0991bef63","status":"passed","time":{"start":1765373012562,"stop":1765373014999,"duration":2437}}]},"tags":["backend"]},"source":"9f35147ffba51210.json","parameterValues":[]}