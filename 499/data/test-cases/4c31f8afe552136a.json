{"uid":"4c31f8afe552136a","name":"Multiple edit Tasks: некорректный assigneeId статус 400 !!! тест должен упасть после исправления бага CCSS-31512 !!! ","fullName":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_assignees#test_multiple_edit_tasks_invalid_assignee_id","historyId":"87fa58ddd0747823b3bcde7380af17b7","time":{"start":1765458191448,"stop":1765458192442,"duration":994},"description":"\n    Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n    Ожидаем HTTP 400 и корректное сообщение об ошибке.\n    Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n    так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n    ","descriptionHtml":"<pre><code>Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\nОжидаем HTTP 400 и корректное сообщение об ошибке.\nБаг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\nтак как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f7a7e437090>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'main': ['6866309d85fb8d104544a620'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], ...}\nmake_task_in_main = <function make_task_in_main.<locals>._create_task at 0x7f7a7e113ec0>\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    @allure.title(\"Multiple edit Tasks: некорректный assigneeId статус 400 !!! тест должен упасть после исправления бага CCSS-31512 !!! \")\n    def test_multiple_edit_tasks_invalid_assignee_id(owner_client, main_space, main_board, main_personal, make_task_in_main):\n        \"\"\"\n        Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n        Ожидаем HTTP 400 и корректное сообщение об ошибке.\n        Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n        так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n        \"\"\"\n        with allure.step(\"Готовим валидные данные и генерируем невалидный assigneeId\"):\n            valid_assignee = main_personal[\"member\"][0]\n            valid_task = make_task_in_main({\"name\": \"Valid task\"})\n            valid_id = valid_task[\"_id\"]\n    \n            invalid_task = make_task_in_main({\"name\": \"InValid task\"})\n            invalid_id = invalid_task[\"_id\"]\n            replaced_digit = \"0\" if valid_id[-1] != \"0\" else \"1\"\n            invalid_assignee = valid_assignee[:-1] + replaced_digit\n    \n        with allure.step(\"Вызываем multiple_edit_tasks с валидным и невалидным assigneeId\"):\n            payload = [\n                {\"taskId\": valid_id, \"assignees\": [valid_assignee]},\n                {\"taskId\": invalid_id, \"assignees\": [invalid_assignee]},\n            ]\n            resp = owner_client.post(**multiple_edit_tasks_endpoint(\n                space_id=main_space,\n                tasks=payload,\n            ))\n>           assert resp.status_code == 200, resp.text # CCSS-31512 400\nE           AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nE           assert 400 == 200\nE            +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py:163: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1765457368185,"stop":1765457368691,"duration":506},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1765457370634,"stop":1765457370872,"duration":238},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1765457370872,"stop":1765457371085,"duration":213},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_personal","time":{"start":1765457407223,"stop":1765457407544,"duration":321},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1765457726227,"stop":1765457726691,"duration":464},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"make_task_in_main","time":{"start":1765458191447,"stop":1765458191447,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n    Ожидаем HTTP 400 и корректное сообщение об ошибке.\n    Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n    так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n    ","status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f7a7e437090>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'main': ['6866309d85fb8d104544a620'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], ...}\nmake_task_in_main = <function make_task_in_main.<locals>._create_task at 0x7f7a7e113ec0>\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    @allure.title(\"Multiple edit Tasks: некорректный assigneeId статус 400 !!! тест должен упасть после исправления бага CCSS-31512 !!! \")\n    def test_multiple_edit_tasks_invalid_assignee_id(owner_client, main_space, main_board, main_personal, make_task_in_main):\n        \"\"\"\n        Передаём валидный и заведомо некорректный идентификаторы ассайни (у второго последняя цифра заменена на 0).\n        Ожидаем HTTP 400 и корректное сообщение об ошибке.\n        Баг: CCSS-31512. сейчас статус 200 !!!! тест должен упасть после исправления бага !!!\n        так как Api только для внутреннего использования баг не сильно кретичен, но нужно будет учесть в OpenApi\n        \"\"\"\n        with allure.step(\"Готовим валидные данные и генерируем невалидный assigneeId\"):\n            valid_assignee = main_personal[\"member\"][0]\n            valid_task = make_task_in_main({\"name\": \"Valid task\"})\n            valid_id = valid_task[\"_id\"]\n    \n            invalid_task = make_task_in_main({\"name\": \"InValid task\"})\n            invalid_id = invalid_task[\"_id\"]\n            replaced_digit = \"0\" if valid_id[-1] != \"0\" else \"1\"\n            invalid_assignee = valid_assignee[:-1] + replaced_digit\n    \n        with allure.step(\"Вызываем multiple_edit_tasks с валидным и невалидным assigneeId\"):\n            payload = [\n                {\"taskId\": valid_id, \"assignees\": [valid_assignee]},\n                {\"taskId\": invalid_id, \"assignees\": [invalid_assignee]},\n            ]\n            resp = owner_client.post(**multiple_edit_tasks_endpoint(\n                space_id=main_space,\n                tasks=payload,\n            ))\n>           assert resp.status_code == 200, resp.text # CCSS-31512 400\nE           AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nE           assert 400 == 200\nE            +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py:163: AssertionError","steps":[{"name":"Готовим валидные данные и генерируем невалидный assigneeId","time":{"start":1765458191448,"stop":1765458192118,"duration":670},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Вызываем multiple_edit_tasks с валидным и невалидным assigneeId","time":{"start":1765458192118,"stop":1765458192441,"duration":323},"status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py\", line 163, in test_multiple_edit_tasks_invalid_assignee_id\n    assert resp.status_code == 200, resp.text # CCSS-31512 400\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"make_task_in_main::0","time":{"start":1765458192447,"stop":1765458193029,"duration":582},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"multiple_edit_tasks"},{"name":"tag","value":"backend"},{"name":"suite","value":"test_multiple_edit_tasks_assignees"},{"name":"host","value":"runnervmoqczp"},{"name":"thread","value":"2641-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_assignees"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":0,"skipped":0,"passed":17,"unknown":0,"total":19},"items":[{"uid":"cfd52212b5c69991","reportUrl":"https://vaizcom.github.io/autotests/498/#testresult/cfd52212b5c69991","status":"passed","time":{"start":1765444443355,"stop":1765444444629,"duration":1274}},{"uid":"bf4acf303408321","reportUrl":"https://vaizcom.github.io/autotests/497/#testresult/bf4acf303408321","status":"passed","time":{"start":1765442555353,"stop":1765442556427,"duration":1074}},{"uid":"4ba3c37d8385e43","reportUrl":"https://vaizcom.github.io/autotests/496/#testresult/4ba3c37d8385e43","status":"passed","time":{"start":1765372968475,"stop":1765372972238,"duration":3763}},{"uid":"a1b20558cee2b195","reportUrl":"https://vaizcom.github.io/autotests/495/#testresult/a1b20558cee2b195","status":"passed","time":{"start":1765274548790,"stop":1765274550710,"duration":1920}},{"uid":"c75f91193d550e47","reportUrl":"https://vaizcom.github.io/autotests/494/#testresult/c75f91193d550e47","status":"passed","time":{"start":1765206720017,"stop":1765206721233,"duration":1216}},{"uid":"ed9b3deba81e2f60","reportUrl":"https://vaizcom.github.io/autotests/493/#testresult/ed9b3deba81e2f60","status":"passed","time":{"start":1765203579862,"stop":1765203581033,"duration":1171}},{"uid":"a9362c84884ae23a","reportUrl":"https://vaizcom.github.io/autotests/492/#testresult/a9362c84884ae23a","status":"passed","time":{"start":1765200722015,"stop":1765200723300,"duration":1285}},{"uid":"36312724b5284a34","reportUrl":"https://vaizcom.github.io/autotests/491/#testresult/36312724b5284a34","status":"passed","time":{"start":1765189302419,"stop":1765189303680,"duration":1261}},{"uid":"996ccc530525824","reportUrl":"https://vaizcom.github.io/autotests/490/#testresult/996ccc530525824","status":"passed","time":{"start":1765187966922,"stop":1765187968083,"duration":1161}},{"uid":"2a80e891244f18b2","reportUrl":"https://vaizcom.github.io/autotests/489/#testresult/2a80e891244f18b2","status":"passed","time":{"start":1764995162468,"stop":1764995163781,"duration":1313}},{"uid":"87c733e48bbe3629","reportUrl":"https://vaizcom.github.io/autotests/488/#testresult/87c733e48bbe3629","status":"passed","time":{"start":1764856190863,"stop":1764856191770,"duration":907}},{"uid":"1b08c837611fea5f","reportUrl":"https://vaizcom.github.io/autotests/487/#testresult/1b08c837611fea5f","status":"passed","time":{"start":1764851573519,"stop":1764851574458,"duration":939}},{"uid":"fd69ff10a255c783","reportUrl":"https://vaizcom.github.io/autotests/486/#testresult/fd69ff10a255c783","status":"passed","time":{"start":1764848844468,"stop":1764848845527,"duration":1059}},{"uid":"dab137086db10b57","reportUrl":"https://vaizcom.github.io/autotests/485/#testresult/dab137086db10b57","status":"passed","time":{"start":1764766898776,"stop":1764766899977,"duration":1201}},{"uid":"b56261c93cb60562","reportUrl":"https://vaizcom.github.io/autotests/484/#testresult/b56261c93cb60562","status":"failed","statusDetails":"AssertionError: <html>\r\n  <head><title>503 Service Temporarily Unavailable</title></head>\r\n  <body>\r\n  <center><h1>503 Service Temporarily Unavailable</h1></center>\r\n  <hr><center>nginx</center>\r\n  </body>\r\n  </html>\r\n  \nassert 503 == 200\n +  where 503 = <Response [503]>.status_code","time":{"start":1764765361581,"stop":1764765361768,"duration":187}},{"uid":"f0357c55f77197f8","reportUrl":"https://vaizcom.github.io/autotests/483/#testresult/f0357c55f77197f8","status":"passed","time":{"start":1764749308767,"stop":1764749309692,"duration":925}},{"uid":"af3ff702827f5a83","reportUrl":"https://vaizcom.github.io/autotests/482/#testresult/af3ff702827f5a83","status":"passed","time":{"start":1764687311420,"stop":1764687312423,"duration":1003}},{"uid":"e683b7bb957bc232","reportUrl":"https://vaizcom.github.io/autotests/481/#testresult/e683b7bb957bc232","status":"passed","time":{"start":1764680352892,"stop":1764680353928,"duration":1036}}]},"tags":["backend"]},"source":"4c31f8afe552136a.json","parameterValues":[]}