{"uid":"aae18a33395b5f6b","name":"Проверка доступа с некорректным ID документа","fullName":"tests.test_backend.document.access_doc.test_matrix_access_docs#test_access_with_invalid_ids","historyId":"d693a5a165c952fab521505229b2fb23","time":{"start":1768298686870,"stop":1768298686990,"duration":120},"description":"\n    Проверяет, что запросы с некорректными document_id или space_id вызывают ошибку.\n    ","descriptionHtml":"<pre><code>Проверяет, что запросы с некорректными document_id или space_id вызывают ошибку.\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: Ожидался статус 400, получен 503\nassert 503 == 400\n +  where 503 = <Response [503]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f78edeb3e50>\ndocument_id = 'invalid-id-789', space_id = 'invalid-space-id'\nexpected_status = 400, expected_error_code = 'InvalidForm'\n\n    @allure.parent_suite(\"Document Service\")\n    @allure.suite(\"Access document\")\n    @allure.title('Проверка доступа с некорректным ID документа')\n    @pytest.mark.parametrize(\n        'document_id, space_id, expected_status, expected_error_code',\n        [\n            ('invalid-id-123', 'valid-space-id', 400, 'InvalidForm'),\n            ('valid-document-id', 'invalid-space-id-456', 400, 'InvalidForm'),\n            ('invalid-id-789', 'invalid-space-id', 400, 'InvalidForm'),\n        ],\n        ids=['invalid document_id', 'invalid space_id', 'invalid both'],\n    )\n    def test_access_with_invalid_ids(owner_client, document_id, space_id, expected_status, expected_error_code):\n        \"\"\"\n        Проверяет, что запросы с некорректными document_id или space_id вызывают ошибку.\n        \"\"\"\n        with allure.step(f'Попытка получить доступ к документу {document_id} в пространстве {space_id}'):\n            response = owner_client.post(**get_document_endpoint(document_id=document_id, space_id=space_id))\n    \n        with allure.step(f'Проверка, что статус ответа = {expected_status} и ошибка соответствующая'):\n>           assert response.status_code == expected_status, f'Ожидался статус {expected_status}, получен {response.status_code}'\nE           AssertionError: Ожидался статус 400, получен 503\nE           assert 503 == 400\nE            +  where 503 = <Response [503]>.status_code\n\ntests/test_backend/document/access_doc/test_matrix_access_docs.py:111: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"owner_client","time":{"start":1768298486051,"stop":1768298486554,"duration":503},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1768298486051,"stop":1768298486051,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1768298486051,"stop":1768298486051,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1768298486051,"stop":1768298486051,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1768298486051,"stop":1768298486051,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Проверяет, что запросы с некорректными document_id или space_id вызывают ошибку.\n    ","status":"failed","statusMessage":"AssertionError: Ожидался статус 400, получен 503\nassert 503 == 400\n +  where 503 = <Response [503]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f78edeb3e50>\ndocument_id = 'invalid-id-789', space_id = 'invalid-space-id'\nexpected_status = 400, expected_error_code = 'InvalidForm'\n\n    @allure.parent_suite(\"Document Service\")\n    @allure.suite(\"Access document\")\n    @allure.title('Проверка доступа с некорректным ID документа')\n    @pytest.mark.parametrize(\n        'document_id, space_id, expected_status, expected_error_code',\n        [\n            ('invalid-id-123', 'valid-space-id', 400, 'InvalidForm'),\n            ('valid-document-id', 'invalid-space-id-456', 400, 'InvalidForm'),\n            ('invalid-id-789', 'invalid-space-id', 400, 'InvalidForm'),\n        ],\n        ids=['invalid document_id', 'invalid space_id', 'invalid both'],\n    )\n    def test_access_with_invalid_ids(owner_client, document_id, space_id, expected_status, expected_error_code):\n        \"\"\"\n        Проверяет, что запросы с некорректными document_id или space_id вызывают ошибку.\n        \"\"\"\n        with allure.step(f'Попытка получить доступ к документу {document_id} в пространстве {space_id}'):\n            response = owner_client.post(**get_document_endpoint(document_id=document_id, space_id=space_id))\n    \n        with allure.step(f'Проверка, что статус ответа = {expected_status} и ошибка соответствующая'):\n>           assert response.status_code == expected_status, f'Ожидался статус {expected_status}, получен {response.status_code}'\nE           AssertionError: Ожидался статус 400, получен 503\nE           assert 503 == 400\nE            +  where 503 = <Response [503]>.status_code\n\ntests/test_backend/document/access_doc/test_matrix_access_docs.py:111: AssertionError","steps":[{"name":"Попытка получить доступ к документу invalid-id-789 в пространстве invalid-space-id","time":{"start":1768298686870,"stop":1768298686989,"duration":119},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка, что статус ответа = 400 и ошибка соответствующая","time":{"start":1768298686989,"stop":1768298686990,"duration":1},"status":"failed","statusMessage":"AssertionError: Ожидался статус 400, получен 503\nassert 503 == 400\n +  where 503 = <Response [503]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/document/access_doc/test_matrix_access_docs.py\", line 111, in test_access_with_invalid_ids\n    assert response.status_code == expected_status, f'Ожидался статус {expected_status}, получен {response.status_code}'\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"suite","value":"Access document"},{"name":"parentSuite","value":"Document Service"},{"name":"tag","value":"backend"},{"name":"host","value":"runnervmi13qx"},{"name":"thread","value":"2651-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.document.access_doc.test_matrix_access_docs"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"document_id","value":"'invalid-id-789'"},{"name":"expected_error_code","value":"'InvalidForm'"},{"name":"expected_status","value":"400"},{"name":"space_id","value":"'invalid-space-id'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":6,"broken":0,"skipped":0,"passed":120,"unknown":0,"total":126},"items":[{"uid":"be4ca74ceaa7c3da","reportUrl":"https://vaizcom.github.io/autotests/529/#testresult/be4ca74ceaa7c3da","status":"passed","time":{"start":1767849877081,"stop":1767849877243,"duration":162}},{"uid":"d873c845724c6418","reportUrl":"https://vaizcom.github.io/autotests/528/#testresult/d873c845724c6418","status":"passed","time":{"start":1766507769570,"stop":1766507769769,"duration":199}},{"uid":"ebd96a6f4713a158","reportUrl":"https://vaizcom.github.io/autotests/527/#testresult/ebd96a6f4713a158","status":"passed","time":{"start":1766506422389,"stop":1766506422594,"duration":205}},{"uid":"5bf2fa4d86fdc49c","reportUrl":"https://vaizcom.github.io/autotests/526/#testresult/5bf2fa4d86fdc49c","status":"passed","time":{"start":1766505273410,"stop":1766505273609,"duration":199}},{"uid":"fe6a447c2729d614","reportUrl":"https://vaizcom.github.io/autotests/525/#testresult/fe6a447c2729d614","status":"passed","time":{"start":1766504214078,"stop":1766504214223,"duration":145}},{"uid":"68cfa090cd99d9","reportUrl":"https://vaizcom.github.io/autotests/524/#testresult/68cfa090cd99d9","status":"passed","time":{"start":1766502978366,"stop":1766502978500,"duration":134}},{"uid":"39029f1a2cbc2d51","reportUrl":"https://vaizcom.github.io/autotests/523/#testresult/39029f1a2cbc2d51","status":"passed","time":{"start":1766497112320,"stop":1766497112458,"duration":138}},{"uid":"38f377ab6b6755fe","reportUrl":"https://vaizcom.github.io/autotests/522/#testresult/38f377ab6b6755fe","status":"passed","time":{"start":1766488760060,"stop":1766488760198,"duration":138}},{"uid":"c05cf6b88416f466","reportUrl":"https://vaizcom.github.io/autotests/521/#testresult/c05cf6b88416f466","status":"passed","time":{"start":1766487318083,"stop":1766487318303,"duration":220}},{"uid":"1b737cf131e92480","reportUrl":"https://vaizcom.github.io/autotests/520/#testresult/1b737cf131e92480","status":"passed","time":{"start":1766412225063,"stop":1766412225227,"duration":164}},{"uid":"a0b0a581c38705a","reportUrl":"https://vaizcom.github.io/autotests/519/#testresult/a0b0a581c38705a","status":"passed","time":{"start":1766406188839,"stop":1766406188974,"duration":135}},{"uid":"fb085a6d371a2bea","reportUrl":"https://vaizcom.github.io/autotests/518/#testresult/fb085a6d371a2bea","status":"passed","time":{"start":1766403850542,"stop":1766403850717,"duration":175}},{"uid":"da7237d3447792b3","reportUrl":"https://vaizcom.github.io/autotests/517/#testresult/da7237d3447792b3","status":"passed","time":{"start":1766402438355,"stop":1766402438508,"duration":153}},{"uid":"c866a5ed3d061dc6","reportUrl":"https://vaizcom.github.io/autotests/516/#testresult/c866a5ed3d061dc6","status":"passed","time":{"start":1766067331166,"stop":1766067331327,"duration":161}},{"uid":"37c7f8218ff6f5c0","reportUrl":"https://vaizcom.github.io/autotests/515/#testresult/37c7f8218ff6f5c0","status":"passed","time":{"start":1766042795391,"stop":1766042795552,"duration":161}},{"uid":"c51c315da19126bd","reportUrl":"https://vaizcom.github.io/autotests/514/#testresult/c51c315da19126bd","status":"passed","time":{"start":1765984154166,"stop":1765984154360,"duration":194}},{"uid":"22e6d28892c1baf3","reportUrl":"https://vaizcom.github.io/autotests/513/#testresult/22e6d28892c1baf3","status":"passed","time":{"start":1765975502168,"stop":1765975502326,"duration":158}},{"uid":"82637a9e6c60527c","reportUrl":"https://vaizcom.github.io/autotests/512/#testresult/82637a9e6c60527c","status":"passed","time":{"start":1765891698666,"stop":1765891698865,"duration":199}},{"uid":"3ca6c98dc2a8f0df","reportUrl":"https://vaizcom.github.io/autotests/511/#testresult/3ca6c98dc2a8f0df","status":"passed","time":{"start":1765889896145,"stop":1765889896328,"duration":183}},{"uid":"9f59d70f66c4b245","reportUrl":"https://vaizcom.github.io/autotests/510/#testresult/9f59d70f66c4b245","status":"passed","time":{"start":1765881016753,"stop":1765881016900,"duration":147}}]},"tags":["backend"]},"source":"aae18a33395b5f6b.json","parameterValues":["'invalid-id-789'","'InvalidForm'","400","'invalid-space-id'"]}