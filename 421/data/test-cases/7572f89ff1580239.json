{"uid":"7572f89ff1580239","name":"Архивирование Personal-документа для роли owner, документ создан в роли Member","fullName":"tests.test_backend.document.access_doc.test_archive_doc#test_archive_personal_doc","historyId":"201d62d71d932f29e744de7d89b72c90","time":{"start":1762516766988,"stop":1762516767391,"duration":403},"status":"failed","statusMessage":"AssertionError: assert 400 == 403\n +  where 400 = <Response [400]>.status_code","statusTrace":"request = <FixtureRequest for <Function test_archive_personal_doc[owner]>>\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], 'owner': ['6866346d85fb8d104544ae41']}\nmain_space = '6866309d85fb8d104544a61e', client_fixture = 'owner_client'\nexpected_status = 403\nmember_client = <tests.core.client.APIClient object at 0x7fe5753a4290>\n\n    @pytest.mark.parametrize(\n        'client_fixture, expected_status',\n        [\n            ('owner_client', 403),\n            ('manager_client', 403),\n            ('member_client', 200),\n            ('guest_client', 403),\n        ],\n        ids=['owner', 'manager', 'member', 'guest'],\n    )\n    def test_archive_personal_doc(request, main_personal, main_space, client_fixture, expected_status, member_client):\n        api_client = request.getfixturevalue(client_fixture)\n        role = client_fixture.replace('_client', '')\n        personal_id = main_personal['member'][0]\n        current_date = datetime.now().strftime('%d.%m_%H:%M:%S')\n        title = f'{current_date} Doc For archive Check'\n    \n        allure.dynamic.title(f'Архивирование Personal-документа для роли {role}, документ создан в роли Member')\n    \n        with allure.step(f'member_client создаёт Personal-документ для архивации ({title})'):\n            create_resp = member_client.post(\n                **create_document_endpoint(kind='Member', kind_id=personal_id, space_id=main_space, title=title)\n            )\n    \n            assert create_resp.status_code == 200\n    \n            doc_id = create_resp.json()['payload']['document']['_id']\n        with allure.step(f'Архивация Personal-документа в роли {role}, {expected_status} (доступно только создателю доки)'):\n            archive_resp = api_client.post(**archive_document_endpoint(space_id=main_space, document_id=doc_id))\n>           assert archive_resp.status_code == expected_status\nE           assert 400 == 403\nE            +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/document/access_doc/test_archive_doc.py:164: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"failed","statusMessage":"AssertionError: assert 400 == 403\n +  where 400 = <Response [400]>.status_code","statusTrace":"request = <FixtureRequest for <Function test_archive_personal_doc[owner]>>\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], 'owner': ['6866346d85fb8d104544ae41']}\nmain_space = '6866309d85fb8d104544a61e', client_fixture = 'owner_client'\nexpected_status = 403\nmember_client = <tests.core.client.APIClient object at 0x7fe5753a4290>\n\n    @pytest.mark.parametrize(\n        'client_fixture, expected_status',\n        [\n            ('owner_client', 403),\n            ('manager_client', 403),\n            ('member_client', 200),\n            ('guest_client', 403),\n        ],\n        ids=['owner', 'manager', 'member', 'guest'],\n    )\n    def test_archive_personal_doc(request, main_personal, main_space, client_fixture, expected_status, member_client):\n        api_client = request.getfixturevalue(client_fixture)\n        role = client_fixture.replace('_client', '')\n        personal_id = main_personal['member'][0]\n        current_date = datetime.now().strftime('%d.%m_%H:%M:%S')\n        title = f'{current_date} Doc For archive Check'\n    \n        allure.dynamic.title(f'Архивирование Personal-документа для роли {role}, документ создан в роли Member')\n    \n        with allure.step(f'member_client создаёт Personal-документ для архивации ({title})'):\n            create_resp = member_client.post(\n                **create_document_endpoint(kind='Member', kind_id=personal_id, space_id=main_space, title=title)\n            )\n    \n            assert create_resp.status_code == 200\n    \n            doc_id = create_resp.json()['payload']['document']['_id']\n        with allure.step(f'Архивация Personal-документа в роли {role}, {expected_status} (доступно только создателю доки)'):\n            archive_resp = api_client.post(**archive_document_endpoint(space_id=main_space, document_id=doc_id))\n>           assert archive_resp.status_code == expected_status\nE           assert 400 == 403\nE            +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/document/access_doc/test_archive_doc.py:164: AssertionError","steps":[{"name":"member_client создаёт Personal-документ для архивации (07.11_11:59:26 Doc For archive Check)","time":{"start":1762516766989,"stop":1762516767257,"duration":268},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Архивация Personal-документа в роли owner, 403 (доступно только создателю доки)","time":{"start":1762516767257,"stop":1762516767391,"duration":134},"status":"failed","statusMessage":"AssertionError: assert 400 == 403\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/document/access_doc/test_archive_doc.py\", line 164, in test_archive_personal_doc\n    assert archive_resp.status_code == expected_status\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"tag","value":"backend"},{"name":"parentSuite","value":"tests.test_backend.document.access_doc"},{"name":"suite","value":"test_archive_doc"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"2586-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.document.access_doc.test_archive_doc"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"client_fixture","value":"'owner_client'"},{"name":"expected_status","value":"403"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":3,"broken":0,"skipped":0,"passed":14,"unknown":0,"total":17},"items":[{"uid":"ec7bb21284988b0c","reportUrl":"https://vaizcom.github.io/autotests/421/#testresult/ec7bb21284988b0c","status":"failed","statusDetails":"AssertionError: assert 400 == 403\n +  where 400 = <Response [400]>.status_code","time":{"start":1762516304321,"stop":1762516304877,"duration":556}},{"uid":"de20926373041d8","reportUrl":"https://vaizcom.github.io/autotests/421/#testresult/de20926373041d8","status":"failed","statusDetails":"AssertionError: assert 400 == 403\n +  where 400 = <Response [400]>.status_code","time":{"start":1762514760393,"stop":1762514760826,"duration":433}},{"uid":"71e1c8ff2c586438","reportUrl":"https://vaizcom.github.io/autotests/420/#testresult/71e1c8ff2c586438","status":"passed","time":{"start":1762507440784,"stop":1762507442151,"duration":1367}},{"uid":"9fefad073c44e351","reportUrl":"https://vaizcom.github.io/autotests/420/#testresult/9fefad073c44e351","status":"passed","time":{"start":1762506140987,"stop":1762506141625,"duration":638}},{"uid":"c04d3c2571d57ff7","reportUrl":"https://vaizcom.github.io/autotests/419/#testresult/c04d3c2571d57ff7","status":"passed","time":{"start":1762505262831,"stop":1762505263437,"duration":606}},{"uid":"bbcf5fa3d29e8c59","reportUrl":"https://vaizcom.github.io/autotests/418/#testresult/bbcf5fa3d29e8c59","status":"passed","time":{"start":1762354234341,"stop":1762354235068,"duration":727}},{"uid":"d0b22f10d86fdc62","reportUrl":"https://vaizcom.github.io/autotests/417/#testresult/d0b22f10d86fdc62","status":"passed","time":{"start":1762353167917,"stop":1762353168660,"duration":743}},{"uid":"1b31e113047a8fed","reportUrl":"https://vaizcom.github.io/autotests/416/#testresult/1b31e113047a8fed","status":"passed","time":{"start":1762349757291,"stop":1762349758106,"duration":815}},{"uid":"65d258bac2929955","reportUrl":"https://vaizcom.github.io/autotests/415/#testresult/65d258bac2929955","status":"passed","time":{"start":1762331770978,"stop":1762331771618,"duration":640}},{"uid":"f6f8a3745fcc458f","reportUrl":"https://vaizcom.github.io/autotests/414/#testresult/f6f8a3745fcc458f","status":"passed","time":{"start":1762328778733,"stop":1762328779538,"duration":805}},{"uid":"6643a62c7230e495","reportUrl":"https://vaizcom.github.io/autotests/413/#testresult/6643a62c7230e495","status":"passed","time":{"start":1762270393627,"stop":1762270394393,"duration":766}},{"uid":"4512d6940952508d","reportUrl":"https://vaizcom.github.io/autotests/412/#testresult/4512d6940952508d","status":"passed","time":{"start":1762269527791,"stop":1762269528969,"duration":1178}},{"uid":"ee9b59ca94f4fbc4","reportUrl":"https://vaizcom.github.io/autotests/411/#testresult/ee9b59ca94f4fbc4","status":"passed","time":{"start":1762269388952,"stop":1762269389965,"duration":1013}},{"uid":"77834764a22ec1db","reportUrl":"https://vaizcom.github.io/autotests/410/#testresult/77834764a22ec1db","status":"passed","time":{"start":1762269268603,"stop":1762269269233,"duration":630}},{"uid":"7e562dd9f6eaebcf","reportUrl":"https://vaizcom.github.io/autotests/409/#testresult/7e562dd9f6eaebcf","status":"passed","time":{"start":1762268649111,"stop":1762268649765,"duration":654}},{"uid":"3e24ae4f532593c0","reportUrl":"https://vaizcom.github.io/autotests/408/#testresult/3e24ae4f532593c0","status":"passed","time":{"start":1762244980011,"stop":1762244980884,"duration":873}}]},"tags":["backend"]},"source":"7572f89ff1580239.json","parameterValues":["'owner_client'","403"]}