{"uid":"bea432ccf23f8b5","name":"Multiple edit Tasks: назначение assignees задачам в которой уже был установлен assignee и задаче без assignee","fullName":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_assignees#test_multiple_edit_tasks_set_assignees","historyId":"38f916249e1174bc8e0d18cd5e3e7a77","time":{"start":1765458187240,"stop":1765458188404,"duration":1164},"description":"\n    Создаём 2 задачи в одной борде: у первой уже стоит ассайни, у второй нет.\n    Затем применяем multiple_edit_tasks_endpoint и проверяем,\n    что у обеих задач установлен только переданный ассайни.\n    ","descriptionHtml":"<pre><code>Создаём 2 задачи в одной борде: у первой уже стоит ассайни, у второй нет.\nЗатем применяем multiple_edit_tasks_endpoint и проверяем,\nчто у обеих задач установлен только переданный ассайни.\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f7a7e437090>\nmain_space = '6866309d85fb8d104544a61e'\nmain_project = '686672af85fb8d104544e798'\nmain_board = '6866731185fb8d104544e826'\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'main': ['6866309d85fb8d104544a620'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], ...}\nmake_task_in_main = <function make_task_in_main.<locals>._create_task at 0x7f7a7e05c900>\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    @allure.title(\"Multiple edit Tasks: назначение assignees задачам в которой уже был установлен assignee и задаче без assignee\")\n    def test_multiple_edit_tasks_set_assignees(owner_client, main_space, main_project, main_board, main_personal, make_task_in_main):\n        \"\"\"\n        Создаём 2 задачи в одной борде: у первой уже стоит ассайни, у второй нет.\n        Затем применяем multiple_edit_tasks_endpoint и проверяем,\n        что у обеих задач установлен только переданный ассайни.\n        \"\"\"\n        with allure.step(\"Определяем целевого ассайни\"):\n            # Берём один валидный id из фикстуры main_personal по указанной роли\n            target_assignee = main_personal[\"member\"][0]\n            a1 = main_personal[\"manager\"][0]\n            a2 = main_personal[\"owner\"][0]\n    \n        with allure.step(\"Создаём задачу №1 c заранее установленным ассайни\"):\n            task1 = make_task_in_main({\n                \"name\": \"Task with assignee\",\n                \"assignees\": [a1, a2]\n            })\n            task1_id = task1[\"_id\"]\n    \n        with allure.step(\"Создаём задачу №2 без ассайни\"):\n            task2 = make_task_in_main({\n                \"name\": \"Task without assignee\",\n            })\n            task2_id = task2[\"_id\"]\n    \n        with allure.step(\"Применяем multiple_edit_tasks с установленным ассайни у обеих задач\"):\n            payload = [\n                {\"taskId\": task1_id, \"assignees\": target_assignee},\n                {\"taskId\": task2_id, \"assignees\": target_assignee},\n            ]\n            resp_edit = owner_client.post(**multiple_edit_tasks_endpoint(\n                space_id=main_space,\n                tasks=payload,\n            ))\n>           assert resp_edit.status_code == 200, resp_edit.text\nE           AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nE           assert 400 == 200\nE            +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py:47: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1765457368185,"stop":1765457368691,"duration":506},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1765457368185,"stop":1765457368185,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1765457370634,"stop":1765457370872,"duration":238},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1765457370872,"stop":1765457371085,"duration":213},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_project","time":{"start":1765457371086,"stop":1765457371309,"duration":223},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_personal","time":{"start":1765457407223,"stop":1765457407544,"duration":321},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1765457726227,"stop":1765457726691,"duration":464},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"make_task_in_main","time":{"start":1765458187240,"stop":1765458187240,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Создаём 2 задачи в одной борде: у первой уже стоит ассайни, у второй нет.\n    Затем применяем multiple_edit_tasks_endpoint и проверяем,\n    что у обеих задач установлен только переданный ассайни.\n    ","status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f7a7e437090>\nmain_space = '6866309d85fb8d104544a61e'\nmain_project = '686672af85fb8d104544e798'\nmain_board = '6866731185fb8d104544e826'\nmain_personal = {'guest': ['686630dd85fb8d104544aac8'], 'main': ['6866309d85fb8d104544a620'], 'manager': ['6866313985fb8d104544ab6c'], 'member': ['6866310b85fb8d104544ab1d'], ...}\nmake_task_in_main = <function make_task_in_main.<locals>._create_task at 0x7f7a7e05c900>\n\n    @allure.parent_suite(\"multiple_edit_tasks\")\n    @allure.title(\"Multiple edit Tasks: назначение assignees задачам в которой уже был установлен assignee и задаче без assignee\")\n    def test_multiple_edit_tasks_set_assignees(owner_client, main_space, main_project, main_board, main_personal, make_task_in_main):\n        \"\"\"\n        Создаём 2 задачи в одной борде: у первой уже стоит ассайни, у второй нет.\n        Затем применяем multiple_edit_tasks_endpoint и проверяем,\n        что у обеих задач установлен только переданный ассайни.\n        \"\"\"\n        with allure.step(\"Определяем целевого ассайни\"):\n            # Берём один валидный id из фикстуры main_personal по указанной роли\n            target_assignee = main_personal[\"member\"][0]\n            a1 = main_personal[\"manager\"][0]\n            a2 = main_personal[\"owner\"][0]\n    \n        with allure.step(\"Создаём задачу №1 c заранее установленным ассайни\"):\n            task1 = make_task_in_main({\n                \"name\": \"Task with assignee\",\n                \"assignees\": [a1, a2]\n            })\n            task1_id = task1[\"_id\"]\n    \n        with allure.step(\"Создаём задачу №2 без ассайни\"):\n            task2 = make_task_in_main({\n                \"name\": \"Task without assignee\",\n            })\n            task2_id = task2[\"_id\"]\n    \n        with allure.step(\"Применяем multiple_edit_tasks с установленным ассайни у обеих задач\"):\n            payload = [\n                {\"taskId\": task1_id, \"assignees\": target_assignee},\n                {\"taskId\": task2_id, \"assignees\": target_assignee},\n            ]\n            resp_edit = owner_client.post(**multiple_edit_tasks_endpoint(\n                space_id=main_space,\n                tasks=payload,\n            ))\n>           assert resp_edit.status_code == 200, resp_edit.text\nE           AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nE           assert 400 == 200\nE            +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py:47: AssertionError","steps":[{"name":"Определяем целевого ассайни","time":{"start":1765458187240,"stop":1765458187240,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Создаём задачу №1 c заранее установленным ассайни","time":{"start":1765458187240,"stop":1765458187745,"duration":505},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Создаём задачу №2 без ассайни","time":{"start":1765458187745,"stop":1765458188141,"duration":396},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Применяем multiple_edit_tasks с установленным ассайни у обеих задач","time":{"start":1765458188142,"stop":1765458188403,"duration":261},"status":"failed","statusMessage":"AssertionError: {\"payload\":null,\"type\":\"MultipleEditTasks\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"actionType\",\"codes\":[\"actionType must be one of the following values: editTask, moveTaskToGroup, moveTaskToBoard, deleteTask, archiveTask, editMilestone\"],\"meta\":{}}],\"originalType\":\"MultipleEditTasks\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/multiple_edit_tasks/test_multiple_edit_tasks_assignees.py\", line 47, in test_multiple_edit_tasks_set_assignees\n    assert resp_edit.status_code == 200, resp_edit.text\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":4,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"make_task_in_main::0","time":{"start":1765458188441,"stop":1765458188993,"duration":552},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"multiple_edit_tasks"},{"name":"tag","value":"backend"},{"name":"suite","value":"test_multiple_edit_tasks_assignees"},{"name":"host","value":"runnervmoqczp"},{"name":"thread","value":"2641-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.multiple_edit_tasks.test_multiple_edit_tasks_assignees"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":4,"broken":0,"skipped":0,"passed":15,"unknown":0,"total":19},"items":[{"uid":"ed1122d70068c316","reportUrl":"https://vaizcom.github.io/autotests/498/#testresult/ed1122d70068c316","status":"passed","time":{"start":1765444437562,"stop":1765444439179,"duration":1617}},{"uid":"f9eddf368aa1a71b","reportUrl":"https://vaizcom.github.io/autotests/497/#testresult/f9eddf368aa1a71b","status":"passed","time":{"start":1765442546532,"stop":1765442548255,"duration":1723}},{"uid":"dca7d9b71d66486a","reportUrl":"https://vaizcom.github.io/autotests/496/#testresult/dca7d9b71d66486a","status":"passed","time":{"start":1765372962664,"stop":1765372964411,"duration":1747}},{"uid":"2be7570c5f4be29f","reportUrl":"https://vaizcom.github.io/autotests/495/#testresult/2be7570c5f4be29f","status":"passed","time":{"start":1765274539342,"stop":1765274542301,"duration":2959}},{"uid":"81e19cc1463b872b","reportUrl":"https://vaizcom.github.io/autotests/494/#testresult/81e19cc1463b872b","status":"passed","time":{"start":1765206711583,"stop":1765206713217,"duration":1634}},{"uid":"2e2ace531a24198e","reportUrl":"https://vaizcom.github.io/autotests/493/#testresult/2e2ace531a24198e","status":"passed","time":{"start":1765203572393,"stop":1765203576013,"duration":3620}},{"uid":"2bc4cd9171799873","reportUrl":"https://vaizcom.github.io/autotests/492/#testresult/2bc4cd9171799873","status":"passed","time":{"start":1765200716720,"stop":1765200718209,"duration":1489}},{"uid":"96e66db09a203d9b","reportUrl":"https://vaizcom.github.io/autotests/491/#testresult/96e66db09a203d9b","status":"passed","time":{"start":1765189297108,"stop":1765189298694,"duration":1586}},{"uid":"ae95a58c7fb1e566","reportUrl":"https://vaizcom.github.io/autotests/490/#testresult/ae95a58c7fb1e566","status":"passed","time":{"start":1765187959481,"stop":1765187963135,"duration":3654}},{"uid":"89ebcf1d93078aae","reportUrl":"https://vaizcom.github.io/autotests/489/#testresult/89ebcf1d93078aae","status":"passed","time":{"start":1764995157286,"stop":1764995158741,"duration":1455}},{"uid":"db3d31f6cc26f9b0","reportUrl":"https://vaizcom.github.io/autotests/488/#testresult/db3d31f6cc26f9b0","status":"passed","time":{"start":1764856186554,"stop":1764856187805,"duration":1251}},{"uid":"7350968e89f8e53a","reportUrl":"https://vaizcom.github.io/autotests/487/#testresult/7350968e89f8e53a","status":"passed","time":{"start":1764851569040,"stop":1764851570368,"duration":1328}},{"uid":"e468283148d1d458","reportUrl":"https://vaizcom.github.io/autotests/486/#testresult/e468283148d1d458","status":"passed","time":{"start":1764848839330,"stop":1764848840867,"duration":1537}},{"uid":"46b4c026f77aab01","reportUrl":"https://vaizcom.github.io/autotests/485/#testresult/46b4c026f77aab01","status":"passed","time":{"start":1764766893079,"stop":1764766894795,"duration":1716}},{"uid":"51d2d42d0afbaea9","reportUrl":"https://vaizcom.github.io/autotests/484/#testresult/51d2d42d0afbaea9","status":"failed","statusDetails":"AssertionError: <html>\r\n  <head><title>503 Service Temporarily Unavailable</title></head>\r\n  <body>\r\n  <center><h1>503 Service Temporarily Unavailable</h1></center>\r\n  <hr><center>nginx</center>\r\n  </body>\r\n  </html>\r\n  \nassert 503 == 200\n +  where 503 = <Response [503]>.status_code","time":{"start":1764765361016,"stop":1764765361184,"duration":168}},{"uid":"1c259370e4bb2227","reportUrl":"https://vaizcom.github.io/autotests/483/#testresult/1c259370e4bb2227","status":"passed","time":{"start":1764749299576,"stop":1764749300936,"duration":1360}},{"uid":"90a6b18457f18d53","reportUrl":"https://vaizcom.github.io/autotests/482/#testresult/90a6b18457f18d53","status":"failed","statusDetails":"AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"assignees\",\"codes\":[\"IllegalField\"],\"meta\":{\"message\":\"One or more members are not part of this workspace\"}}],\"originalType\":\"CreateTask\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","time":{"start":1764687308310,"stop":1764687308579,"duration":269}},{"uid":"4bf2ea67eff36fd9","reportUrl":"https://vaizcom.github.io/autotests/481/#testresult/4bf2ea67eff36fd9","status":"failed","statusDetails":"AssertionError: {\"payload\":null,\"type\":\"CreateTask\",\"error\":{\"code\":\"InvalidForm\",\"fields\":[{\"name\":\"assignees\",\"codes\":[\"IllegalField\"],\"meta\":{\"message\":\"One or more members are not part of this workspace\"}}],\"originalType\":\"CreateTask\"}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","time":{"start":1764680349532,"stop":1764680349810,"duration":278}}]},"tags":["backend"]},"source":"bea432ccf23f8b5.json","parameterValues":[]}