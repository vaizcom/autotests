{"uid":"36242c37171a7cf9","name":"Delete Task: Проверка удаление всех задач на доске","fullName":"tests.test_backend.task_service.del_task.test_delete_all_tasks_on_main_board#test_delete_all_tasks_on_main_board","historyId":"7fead678a02d504e7920ab33cb86abb2","time":{"start":1768470205337,"stop":1768470214709,"duration":9372},"description":"\n    Удаляет все задачи на основной доске (main_board).\n    ","descriptionHtml":"<pre><code>Удаляет все задачи на основной доске (main_board).\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: Не удалось удалить задачу 6968af309c34fd133534faba: {\"payload\":null,\"type\":\"DeleteTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"DeleteTask\",\"meta\":{\"context\":\"CastError\",\"message\":\"Cast to ObjectId failed for value \\\"fake1\\\" (type string) at path \\\"_id\\\" for model \\\"Milestone\\\"\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"request = <FixtureRequest for <Function test_delete_all_tasks_on_main_board>>\nowner_client = <tests.core.client.APIClient object at 0x7fcdc928ba10>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\ncreate_task_in_main = <function create_task_in_main.<locals>._create_task at 0x7fcdc8f20b80>\n\n    @allure.parent_suite(\"Task Service\")\n    @allure.suite(\"Delete Task\")\n    @allure.title(\"Delete Task: Проверка удаление всех задач на доске\")\n    def test_delete_all_tasks_on_main_board(request, owner_client, main_space, main_board, create_task_in_main):\n        \"\"\"\n        Удаляет все задачи на основной доске (main_board).\n        \"\"\"\n    \n        client = get_client(request, \"owner_client\")\n        created_task_ids = []\n        random_count = random.randint(1, 10)\n        for i in range(1, random_count + 1):\n            task = create_task_in_main(\n                \"owner_client\",\n                name=f\"Random task #{i}\",\n            )\n            created_task_ids.append(task[\"_id\"])\n    \n        with allure.step(\"Запрашиваем список всех задач на main_board\"):\n            response = client.post(**get_tasks_endpoint(board=main_board, space_id=main_space))\n            assert response.status_code == 200, f\"Не удалось получить список задач: {response.text}\"\n            tasks = response.json()[\"payload\"].get(\"tasks\", [])\n    \n        if not tasks:\n            allure.attach(\"Задачи на доске отсутствуют, нечего удалять.\", \"Комментарии\", \"text/plain\")\n            return\n    \n        with allure.step(\"Удаляем в цикле все созданные задачи\"):\n            deleted_ids = []\n            for task in tasks:\n                task_id = task[\"_id\"]\n                del_resp = client.post(**delete_task_endpoint(task_id=task_id, space_id=main_space))\n>               assert del_resp.status_code == 200, f\"Не удалось удалить задачу {task_id}: {del_resp.text}\"\nE               AssertionError: Не удалось удалить задачу 6968af309c34fd133534faba: {\"payload\":null,\"type\":\"DeleteTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"DeleteTask\",\"meta\":{\"context\":\"CastError\",\"message\":\"Cast to ObjectId failed for value \\\"fake1\\\" (type string) at path \\\"_id\\\" for model \\\"Milestone\\\"\"}}}\nE               assert 400 == 200\nE                +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/del_task/test_delete_all_tasks_on_main_board.py:43: AssertionError","flaky":true,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1768469387918,"stop":1768469387919,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1768469387919,"stop":1768469387919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1768469387919,"stop":1768469387919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1768469387919,"stop":1768469387919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1768469387919,"stop":1768469388334,"duration":415},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1768469389917,"stop":1768469390150,"duration":233},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1768469390150,"stop":1768469390554,"duration":404},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_project","time":{"start":1768469390554,"stop":1768469390753,"duration":199},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1768469394995,"stop":1768469395230,"duration":235},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"create_task_in_main","time":{"start":1768470205337,"stop":1768470205337,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Удаляет все задачи на основной доске (main_board).\n    ","status":"failed","statusMessage":"AssertionError: Не удалось удалить задачу 6968af309c34fd133534faba: {\"payload\":null,\"type\":\"DeleteTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"DeleteTask\",\"meta\":{\"context\":\"CastError\",\"message\":\"Cast to ObjectId failed for value \\\"fake1\\\" (type string) at path \\\"_id\\\" for model \\\"Milestone\\\"\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","statusTrace":"request = <FixtureRequest for <Function test_delete_all_tasks_on_main_board>>\nowner_client = <tests.core.client.APIClient object at 0x7fcdc928ba10>\nmain_space = '6866309d85fb8d104544a61e', main_board = '6866731185fb8d104544e826'\ncreate_task_in_main = <function create_task_in_main.<locals>._create_task at 0x7fcdc8f20b80>\n\n    @allure.parent_suite(\"Task Service\")\n    @allure.suite(\"Delete Task\")\n    @allure.title(\"Delete Task: Проверка удаление всех задач на доске\")\n    def test_delete_all_tasks_on_main_board(request, owner_client, main_space, main_board, create_task_in_main):\n        \"\"\"\n        Удаляет все задачи на основной доске (main_board).\n        \"\"\"\n    \n        client = get_client(request, \"owner_client\")\n        created_task_ids = []\n        random_count = random.randint(1, 10)\n        for i in range(1, random_count + 1):\n            task = create_task_in_main(\n                \"owner_client\",\n                name=f\"Random task #{i}\",\n            )\n            created_task_ids.append(task[\"_id\"])\n    \n        with allure.step(\"Запрашиваем список всех задач на main_board\"):\n            response = client.post(**get_tasks_endpoint(board=main_board, space_id=main_space))\n            assert response.status_code == 200, f\"Не удалось получить список задач: {response.text}\"\n            tasks = response.json()[\"payload\"].get(\"tasks\", [])\n    \n        if not tasks:\n            allure.attach(\"Задачи на доске отсутствуют, нечего удалять.\", \"Комментарии\", \"text/plain\")\n            return\n    \n        with allure.step(\"Удаляем в цикле все созданные задачи\"):\n            deleted_ids = []\n            for task in tasks:\n                task_id = task[\"_id\"]\n                del_resp = client.post(**delete_task_endpoint(task_id=task_id, space_id=main_space))\n>               assert del_resp.status_code == 200, f\"Не удалось удалить задачу {task_id}: {del_resp.text}\"\nE               AssertionError: Не удалось удалить задачу 6968af309c34fd133534faba: {\"payload\":null,\"type\":\"DeleteTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"DeleteTask\",\"meta\":{\"context\":\"CastError\",\"message\":\"Cast to ObjectId failed for value \\\"fake1\\\" (type string) at path \\\"_id\\\" for model \\\"Milestone\\\"\"}}}\nE               assert 400 == 200\nE                +  where 400 = <Response [400]>.status_code\n\ntests/test_backend/task_service/del_task/test_delete_all_tasks_on_main_board.py:43: AssertionError","steps":[{"name":"Запрашиваем список всех задач на main_board","time":{"start":1768470214056,"stop":1768470214488,"duration":432},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Удаляем в цикле все созданные задачи","time":{"start":1768470214488,"stop":1768470214709,"duration":221},"status":"failed","statusMessage":"AssertionError: Не удалось удалить задачу 6968af309c34fd133534faba: {\"payload\":null,\"type\":\"DeleteTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"DeleteTask\",\"meta\":{\"context\":\"CastError\",\"message\":\"Cast to ObjectId failed for value \\\"fake1\\\" (type string) at path \\\"_id\\\" for model \\\"Milestone\\\"\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/del_task/test_delete_all_tasks_on_main_board.py\", line 43, in test_delete_all_tasks_on_main_board\n    assert del_resp.status_code == 200, f\"Не удалось удалить задачу {task_id}: {del_resp.text}\"\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"Task Service"},{"name":"suite","value":"Delete Task"},{"name":"tag","value":"backend"},{"name":"host","value":"runnervmmtnos"},{"name":"thread","value":"2637-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.del_task.test_delete_all_tasks_on_main_board"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":1,"skipped":0,"passed":60,"unknown":0,"total":63},"items":[{"uid":"826aa53af06376b5","reportUrl":"https://vaizcom.github.io/autotests/534/#testresult/826aa53af06376b5","status":"passed","time":{"start":1768468240638,"stop":1768468250362,"duration":9724}},{"uid":"8afc45e51dd74a66","reportUrl":"https://vaizcom.github.io/autotests/533/#testresult/8afc45e51dd74a66","status":"failed","statusDetails":"AssertionError: Не удалось удалить задачу 6966620907a7b1868dd6af77: {\"payload\":null,\"type\":\"DeleteTask\",\"error\":{\"code\":\"InternalServerError\",\"fields\":[],\"originalType\":\"DeleteTask\",\"meta\":{\"context\":\"CastError\",\"message\":\"Cast to ObjectId failed for value \\\"fake1\\\" (type string) at path \\\"_id\\\" for model \\\"Milestone\\\"\"}}}\nassert 400 == 200\n +  where 400 = <Response [400]>.status_code","time":{"start":1768404015860,"stop":1768404028783,"duration":12923}},{"uid":"c40c85c9ce982f09","reportUrl":"https://vaizcom.github.io/autotests/532/#testresult/c40c85c9ce982f09","status":"passed","time":{"start":1768317413285,"stop":1768317428685,"duration":15400}},{"uid":"6ac1bdccdf96d60f","reportUrl":"https://vaizcom.github.io/autotests/531/#testresult/6ac1bdccdf96d60f","status":"passed","time":{"start":1768300067663,"stop":1768300081488,"duration":13825}},{"uid":"77869ef0ac7446c4","reportUrl":"https://vaizcom.github.io/autotests/530/#testresult/77869ef0ac7446c4","status":"broken","statusDetails":"requests.exceptions.HTTPError: 503 Server Error: Service Unavailable for url: https://vaiz-api-ms.vaiz.dev/v4/GetBoard","time":{"start":1768298709158,"stop":1768298709280,"duration":122}},{"uid":"676c68583240f173","reportUrl":"https://vaizcom.github.io/autotests/529/#testresult/676c68583240f173","status":"passed","time":{"start":1767850252021,"stop":1767850266488,"duration":14467}},{"uid":"25b0561b9ff5ec44","reportUrl":"https://vaizcom.github.io/autotests/528/#testresult/25b0561b9ff5ec44","status":"passed","time":{"start":1766508187181,"stop":1766508189688,"duration":2507}},{"uid":"6ca7b2d94879571","reportUrl":"https://vaizcom.github.io/autotests/527/#testresult/6ca7b2d94879571","status":"passed","time":{"start":1766506810222,"stop":1766506826854,"duration":16632}},{"uid":"8604e751f282a970","reportUrl":"https://vaizcom.github.io/autotests/526/#testresult/8604e751f282a970","status":"passed","time":{"start":1766505637926,"stop":1766505646970,"duration":9044}},{"uid":"6ccddc80d0b3d90f","reportUrl":"https://vaizcom.github.io/autotests/525/#testresult/6ccddc80d0b3d90f","status":"passed","time":{"start":1766504575476,"stop":1766504586951,"duration":11475}},{"uid":"cb6a0e69018e09eb","reportUrl":"https://vaizcom.github.io/autotests/524/#testresult/cb6a0e69018e09eb","status":"passed","time":{"start":1766503295341,"stop":1766503300226,"duration":4885}},{"uid":"cf0148064969bb04","reportUrl":"https://vaizcom.github.io/autotests/523/#testresult/cf0148064969bb04","status":"passed","time":{"start":1766497456886,"stop":1766497461586,"duration":4700}},{"uid":"36cbdac47c42414","reportUrl":"https://vaizcom.github.io/autotests/522/#testresult/36cbdac47c42414","status":"passed","time":{"start":1766489079132,"stop":1766489086106,"duration":6974}},{"uid":"3023eef51c2221cd","reportUrl":"https://vaizcom.github.io/autotests/521/#testresult/3023eef51c2221cd","status":"passed","time":{"start":1766487745046,"stop":1766487760011,"duration":14965}},{"uid":"5c4c7b5332abad60","reportUrl":"https://vaizcom.github.io/autotests/520/#testresult/5c4c7b5332abad60","status":"passed","time":{"start":1766412595612,"stop":1766412598259,"duration":2647}},{"uid":"81b68c96787e8acd","reportUrl":"https://vaizcom.github.io/autotests/519/#testresult/81b68c96787e8acd","status":"passed","time":{"start":1766406542347,"stop":1766406550539,"duration":8192}},{"uid":"e75bcaad61c33249","reportUrl":"https://vaizcom.github.io/autotests/518/#testresult/e75bcaad61c33249","status":"passed","time":{"start":1766404206781,"stop":1766404214007,"duration":7226}},{"uid":"197c9d8084a17d8d","reportUrl":"https://vaizcom.github.io/autotests/517/#testresult/197c9d8084a17d8d","status":"passed","time":{"start":1766402856350,"stop":1766402861765,"duration":5415}},{"uid":"978bbe6e4ecff367","reportUrl":"https://vaizcom.github.io/autotests/516/#testresult/978bbe6e4ecff367","status":"passed","time":{"start":1766067769883,"stop":1766067778019,"duration":8136}},{"uid":"97dc9d376cef044a","reportUrl":"https://vaizcom.github.io/autotests/515/#testresult/97dc9d376cef044a","status":"passed","time":{"start":1766043192739,"stop":1766043197357,"duration":4618}}]},"tags":["backend"]},"source":"36242c37171a7cf9.json","parameterValues":[]}