{"uid":"8e0b45b447dd6d48","name":"Проверка сортировки задач по createdAt: по убыванию (новые сверху)","fullName":"tests.test_backend.task_service.get_tasks.task_criteria_desc.test_get_tasks_sorting_by_created_at_desc#test_get_tasks_sorting_by_created_at_desc","historyId":"416c795dd50610306bd49f1064a1e020","time":{"start":1763023464559,"stop":1763023464825,"duration":266},"description":"Проверяет сортировку задач по дате создания в порядке убывания (новые сверху)","descriptionHtml":"<p>Проверяет сортировку задач по дате создания в порядке убывания (новые сверху)</p>\n","status":"failed","statusMessage":"AssertionError: Нарушена сортировка по убыванию: позиции 1 (2025-11-04 10:30:07.463000+00:00) и 2 (2025-11-04 10:30:07.996000+00:00)\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 996000, tzinfo=tzlocal())","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f3ee44de650>\nmain_space = '6866309d85fb8d104544a61e'\nboard_with_tasks = '6909d4141a593d8d7c3b9f91'\n\n    @allure.title(\"Проверка сортировки задач по createdAt: по убыванию (новые сверху)\")\n    def test_get_tasks_sorting_by_created_at_desc(owner_client, main_space, board_with_tasks):\n        \"\"\"Проверяет сортировку задач по дате создания в порядке убывания (новые сверху)\"\"\"\n        LIMIT = 20\n    \n        with allure.step(f\"Запрос задач: createdAt DESC, limit={LIMIT}\"):\n            resp = owner_client.post(**get_tasks_endpoint(\n                space_id=main_space,\n                board=board_with_tasks,\n                sortCriteria=\"createdAt\",\n                sortDirection=-1,\n                limit=LIMIT\n            ))\n        with allure.step(\"Проверить HTTP 200\"):\n            assert resp.status_code == 200\n    \n        with allure.step(\"Извлечь задачи и проверить лимит\"):\n            tasks = resp.json()[\"payload\"][\"tasks\"]\n            assert tasks, \"Ожидаются задачи в ответе\"\n    \n        # Если данных недостаточно для сравнения — корректно пропускаем тест\n        if len(tasks) <= 2:\n            pytest.skip(f\"Недостаточно данных для проверки убывания: получено {len(tasks)} (нужно > 2)\")\n    \n        with allure.step(\"Проверить убывание по createdAt (новые задачи сверху)\"):\n            try:\n                created_dates = [parser.parse(task[\"createdAt\"]) for task in tasks]\n            except Exception as e:\n                raise AssertionError(f\"Не удалось распарсить createdAt в одной из задач: {e}\")\n    \n            for i in range(len(created_dates) - 1):\n>               assert created_dates[i] >= created_dates[i + 1], (\n                    f\"Нарушена сортировка по убыванию: позиции {i} ({created_dates[i]}) и {i+1} ({created_dates[i+1]})\"\n                )\nE               AssertionError: Нарушена сортировка по убыванию: позиции 1 (2025-11-04 10:30:07.463000+00:00) и 2 (2025-11-04 10:30:07.996000+00:00)\nE               assert datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 996000, tzinfo=tzlocal())\n\ntests/test_backend/task_service/get_tasks/task_criteria_desc/test_get_tasks_sorting_by_created_at_desc.py:39: AssertionError","flaky":true,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"description":"Проверяет сортировку задач по дате создания в порядке убывания (новые сверху)","status":"failed","statusMessage":"AssertionError: Нарушена сортировка по убыванию: позиции 1 (2025-11-04 10:30:07.463000+00:00) и 2 (2025-11-04 10:30:07.996000+00:00)\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 996000, tzinfo=tzlocal())","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f3ee44de650>\nmain_space = '6866309d85fb8d104544a61e'\nboard_with_tasks = '6909d4141a593d8d7c3b9f91'\n\n    @allure.title(\"Проверка сортировки задач по createdAt: по убыванию (новые сверху)\")\n    def test_get_tasks_sorting_by_created_at_desc(owner_client, main_space, board_with_tasks):\n        \"\"\"Проверяет сортировку задач по дате создания в порядке убывания (новые сверху)\"\"\"\n        LIMIT = 20\n    \n        with allure.step(f\"Запрос задач: createdAt DESC, limit={LIMIT}\"):\n            resp = owner_client.post(**get_tasks_endpoint(\n                space_id=main_space,\n                board=board_with_tasks,\n                sortCriteria=\"createdAt\",\n                sortDirection=-1,\n                limit=LIMIT\n            ))\n        with allure.step(\"Проверить HTTP 200\"):\n            assert resp.status_code == 200\n    \n        with allure.step(\"Извлечь задачи и проверить лимит\"):\n            tasks = resp.json()[\"payload\"][\"tasks\"]\n            assert tasks, \"Ожидаются задачи в ответе\"\n    \n        # Если данных недостаточно для сравнения — корректно пропускаем тест\n        if len(tasks) <= 2:\n            pytest.skip(f\"Недостаточно данных для проверки убывания: получено {len(tasks)} (нужно > 2)\")\n    \n        with allure.step(\"Проверить убывание по createdAt (новые задачи сверху)\"):\n            try:\n                created_dates = [parser.parse(task[\"createdAt\"]) for task in tasks]\n            except Exception as e:\n                raise AssertionError(f\"Не удалось распарсить createdAt в одной из задач: {e}\")\n    \n            for i in range(len(created_dates) - 1):\n>               assert created_dates[i] >= created_dates[i + 1], (\n                    f\"Нарушена сортировка по убыванию: позиции {i} ({created_dates[i]}) и {i+1} ({created_dates[i+1]})\"\n                )\nE               AssertionError: Нарушена сортировка по убыванию: позиции 1 (2025-11-04 10:30:07.463000+00:00) и 2 (2025-11-04 10:30:07.996000+00:00)\nE               assert datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 996000, tzinfo=tzlocal())\n\ntests/test_backend/task_service/get_tasks/task_criteria_desc/test_get_tasks_sorting_by_created_at_desc.py:39: AssertionError","steps":[{"name":"Запрос задач: createdAt DESC, limit=20","time":{"start":1763023464559,"stop":1763023464823,"duration":264},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверить HTTP 200","time":{"start":1763023464823,"stop":1763023464823,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Извлечь задачи и проверить лимит","time":{"start":1763023464823,"stop":1763023464823,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверить убывание по createdAt (новые задачи сверху)","time":{"start":1763023464823,"stop":1763023464825,"duration":2},"status":"failed","statusMessage":"AssertionError: Нарушена сортировка по убыванию: позиции 1 (2025-11-04 10:30:07.463000+00:00) и 2 (2025-11-04 10:30:07.996000+00:00)\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 996000, tzinfo=tzlocal())\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/get_tasks/task_criteria_desc/test_get_tasks_sorting_by_created_at_desc.py\", line 39, in test_get_tasks_sorting_by_created_at_desc\n    assert created_dates[i] >= created_dates[i + 1], (\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":4,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"tag","value":"backend"},{"name":"parentSuite","value":"tests.test_backend.task_service.get_tasks.task_criteria_desc"},{"name":"suite","value":"test_get_tasks_sorting_by_created_at_desc"},{"name":"host","value":"runnervmw9dnm"},{"name":"thread","value":"2578-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.get_tasks.task_criteria_desc.test_get_tasks_sorting_by_created_at_desc"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":3,"broken":0,"skipped":0,"passed":1,"unknown":0,"total":4},"items":[{"uid":"11fd7a2addf7f74a","reportUrl":"https://vaizcom.github.io/autotests/438/#testresult/11fd7a2addf7f74a","status":"failed","statusDetails":"AssertionError: Нарушена сортировка по убыванию: позиции 1 (2025-11-04 10:30:07.463000+00:00) и 2 (2025-11-04 10:30:07.996000+00:00)\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 996000, tzinfo=tzlocal())","time":{"start":1763021081027,"stop":1763021081280,"duration":253}},{"uid":"b905642b6d41cb5c","reportUrl":"https://vaizcom.github.io/autotests/436/#testresult/b905642b6d41cb5c","status":"passed","time":{"start":1762972666488,"stop":1762972672387,"duration":5899}},{"uid":"3ffbb181f9de3247","reportUrl":"https://vaizcom.github.io/autotests/434/#testresult/3ffbb181f9de3247","status":"failed","statusDetails":"AssertionError: Нарушена сортировка по убыванию: 2025-11-04 10:30:07.199000+00:00 должна быть >= 2025-11-04 10:30:07.463000+00:00\nassert datetime.datetime(2025, 11, 4, 10, 30, 7, 199000, tzinfo=tzlocal()) >= datetime.datetime(2025, 11, 4, 10, 30, 7, 463000, tzinfo=tzlocal())","time":{"start":1762951013385,"stop":1762951018569,"duration":5184}}]},"tags":["backend"]},"source":"8e0b45b447dd6d48.json","parameterValues":[]}