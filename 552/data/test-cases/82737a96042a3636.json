{"uid":"82737a96042a3636","name":"Create Task: Проверка уменьшения счетчика сабтасок после удаления сабтасок в родительской задаче","fullName":"tests.test_backend.task_service.create_task.test_taskTable_total_subtask_counter#test_parent_task_total_subtask_count_decrease_after_subtask_deletion","historyId":"6e5453821c2c646b30b62b3f5cce55d8","time":{"start":1770371340305,"stop":1770371362983,"duration":22678},"description":"\n    Тест проверяет корректное уменьшение счетчика total сабтасок после удаления подзадач.\n    ","descriptionHtml":"<pre><code>Тест проверяет корректное уменьшение счетчика total сабтасок после удаления подзадач.\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: Ожидалось total=10, получили 9\nassert 9 == 10","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f5bd835f390>\nmain_space = '6866309d85fb8d104544a61e'\ncreate_task_in_main = <function create_task_in_main.<locals>._create_task at 0x7f5bd802f2e0>\n\n    @allure.parent_suite(\"Task Service\")\n    @allure.suite(\"Create Task\")\n    @allure.title(\"Create Task: Проверка уменьшения счетчика сабтасок после удаления сабтасок в родительской задаче\")\n    def test_parent_task_total_subtask_count_decrease_after_subtask_deletion(owner_client, main_space, create_task_in_main):\n        \"\"\"\n        Тест проверяет корректное уменьшение счетчика total сабтасок после удаления подзадач.\n        \"\"\"\n        client = owner_client\n        # Создаем родительскую задачу\n        parent_task = create_task_in_main(\"owner_client\", name=\"Parent task for decrease subtask total test\")\n        parent_task_id = parent_task[\"_id\"]\n        created_subtask_ids = []\n    \n        try:\n            with allure.step(\"Создаем рандомное количество сабтасок (от 1 до 10) для родительской задачи\"):\n                random_count = random.randint(1, 10)\n                for i in range(1, random_count + 1):\n                    subtask = create_task_in_main(\n                        \"owner_client\",\n                        parent_task=parent_task_id,\n                        name=f\"Subtask #{i} for decrease subtask total test\",\n                    )\n                    created_subtask_ids.append(subtask[\"_id\"])\n    \n            with allure.step(\"Проверяем, что total соответствует количеству созданных сабтасок\"):\n                total_after_creation = get_parent_task_subtask_count(client, main_space, parent_task_id)\n>               assert total_after_creation == random_count, f\"Ожидалось total={random_count}, получили {total_after_creation}\"\nE               AssertionError: Ожидалось total=10, получили 9\nE               assert 9 == 10\n\ntests/test_backend/task_service/create_task/test_taskTable_total_subtask_counter.py:101: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1770370751536,"stop":1770370751536,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1770370751536,"stop":1770370751536,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1770370751536,"stop":1770370751536,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1770370751537,"stop":1770370751537,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"owner_client","time":{"start":1770370751537,"stop":1770370751821,"duration":284},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_client","time":{"start":1770370755245,"stop":1770370755830,"duration":585},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_space","time":{"start":1770370755830,"stop":1770370756103,"duration":273},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_project","time":{"start":1770370756104,"stop":1770370756657,"duration":553},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"main_board","time":{"start":1770370760744,"stop":1770370761015,"duration":271},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"create_task_in_main","time":{"start":1770371340304,"stop":1770371340304,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Тест проверяет корректное уменьшение счетчика total сабтасок после удаления подзадач.\n    ","status":"failed","statusMessage":"AssertionError: Ожидалось total=10, получили 9\nassert 9 == 10","statusTrace":"owner_client = <tests.core.client.APIClient object at 0x7f5bd835f390>\nmain_space = '6866309d85fb8d104544a61e'\ncreate_task_in_main = <function create_task_in_main.<locals>._create_task at 0x7f5bd802f2e0>\n\n    @allure.parent_suite(\"Task Service\")\n    @allure.suite(\"Create Task\")\n    @allure.title(\"Create Task: Проверка уменьшения счетчика сабтасок после удаления сабтасок в родительской задаче\")\n    def test_parent_task_total_subtask_count_decrease_after_subtask_deletion(owner_client, main_space, create_task_in_main):\n        \"\"\"\n        Тест проверяет корректное уменьшение счетчика total сабтасок после удаления подзадач.\n        \"\"\"\n        client = owner_client\n        # Создаем родительскую задачу\n        parent_task = create_task_in_main(\"owner_client\", name=\"Parent task for decrease subtask total test\")\n        parent_task_id = parent_task[\"_id\"]\n        created_subtask_ids = []\n    \n        try:\n            with allure.step(\"Создаем рандомное количество сабтасок (от 1 до 10) для родительской задачи\"):\n                random_count = random.randint(1, 10)\n                for i in range(1, random_count + 1):\n                    subtask = create_task_in_main(\n                        \"owner_client\",\n                        parent_task=parent_task_id,\n                        name=f\"Subtask #{i} for decrease subtask total test\",\n                    )\n                    created_subtask_ids.append(subtask[\"_id\"])\n    \n            with allure.step(\"Проверяем, что total соответствует количеству созданных сабтасок\"):\n                total_after_creation = get_parent_task_subtask_count(client, main_space, parent_task_id)\n>               assert total_after_creation == random_count, f\"Ожидалось total={random_count}, получили {total_after_creation}\"\nE               AssertionError: Ожидалось total=10, получили 9\nE               assert 9 == 10\n\ntests/test_backend/task_service/create_task/test_taskTable_total_subtask_counter.py:101: AssertionError","steps":[{"name":"Создаем рандомное количество сабтасок (от 1 до 10) для родительской задачи","time":{"start":1770371341814,"stop":1770371357176,"duration":15362},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяем, что total соответствует количеству созданных сабтасок","time":{"start":1770371357176,"stop":1770371357534,"duration":358},"status":"failed","statusMessage":"AssertionError: Ожидалось total=10, получили 9\nassert 9 == 10\n","statusTrace":"  File \"/home/runner/work/autotests/autotests/tests/test_backend/task_service/create_task/test_taskTable_total_subtask_counter.py\", line 101, in test_parent_task_total_subtask_count_decrease_after_subtask_deletion\n    assert total_after_creation == random_count, f\"Ожидалось total={random_count}, получили {total_after_creation}\"\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Удаляем сабтаски и родительскую задачу принудительно (на случай если тесты упадут)","time":{"start":1770371357535,"stop":1770371362982,"duration":5447},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[{"uid":"b41f61e1df4b9077","name":"stdout","source":"b41f61e1df4b9077.txt","type":"text/plain","size":498}],"parameters":[],"stepsCount":3,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"suite","value":"Create Task"},{"name":"parentSuite","value":"Task Service"},{"name":"tag","value":"backend"},{"name":"host","value":"runnervmkj6or"},{"name":"thread","value":"2746-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_backend.task_service.create_task.test_taskTable_total_subtask_counter"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":8,"skipped":0,"passed":137,"unknown":0,"total":147},"items":[{"uid":"725e8f3c03d4a2aa","reportUrl":"https://vaizcom.github.io/autotests/551/#testresult/725e8f3c03d4a2aa","status":"passed","time":{"start":1770298919041,"stop":1770298937798,"duration":18757}},{"uid":"ecb1eb853ed4db8a","reportUrl":"https://vaizcom.github.io/autotests/550/#testresult/ecb1eb853ed4db8a","status":"passed","time":{"start":1770291088476,"stop":1770291095417,"duration":6941}},{"uid":"83e652d0d4d031c5","reportUrl":"https://vaizcom.github.io/autotests/549/#testresult/83e652d0d4d031c5","status":"passed","time":{"start":1770281818123,"stop":1770281822601,"duration":4478}},{"uid":"eb77ad5546b92086","reportUrl":"https://vaizcom.github.io/autotests/548/#testresult/eb77ad5546b92086","status":"passed","time":{"start":1770276148802,"stop":1770276165989,"duration":17187}},{"uid":"e3cb7f8ef20c4de2","reportUrl":"https://vaizcom.github.io/autotests/547/#testresult/e3cb7f8ef20c4de2","status":"passed","time":{"start":1769092856285,"stop":1769092886837,"duration":30552}},{"uid":"b5ef876c3e35c6fa","reportUrl":"https://vaizcom.github.io/autotests/546/#testresult/b5ef876c3e35c6fa","status":"passed","time":{"start":1769007978922,"stop":1769007984539,"duration":5617}},{"uid":"48794aa3ae33244f","reportUrl":"https://vaizcom.github.io/autotests/545/#testresult/48794aa3ae33244f","status":"passed","time":{"start":1768995270039,"stop":1768995288593,"duration":18554}},{"uid":"5122ec6d565290ea","reportUrl":"https://vaizcom.github.io/autotests/544/#testresult/5122ec6d565290ea","status":"passed","time":{"start":1768815597359,"stop":1768815615970,"duration":18611}},{"uid":"a5f385c766b4a72b","reportUrl":"https://vaizcom.github.io/autotests/543/#testresult/a5f385c766b4a72b","status":"passed","time":{"start":1768812494966,"stop":1768812513807,"duration":18841}},{"uid":"93bf702840de8e09","reportUrl":"https://vaizcom.github.io/autotests/541/#testresult/93bf702840de8e09","status":"passed","time":{"start":1768810333056,"stop":1768810344915,"duration":11859}},{"uid":"564347adebbd6e3f","reportUrl":"https://vaizcom.github.io/autotests/542/#testresult/564347adebbd6e3f","status":"passed","time":{"start":1768573657055,"stop":1768573677342,"duration":20287}},{"uid":"28e7f3b2676fab4c","reportUrl":"https://vaizcom.github.io/autotests/540/#testresult/28e7f3b2676fab4c","status":"passed","time":{"start":1768571882080,"stop":1768571911472,"duration":29392}},{"uid":"2744815d7796d694","reportUrl":"https://vaizcom.github.io/autotests/539/#testresult/2744815d7796d694","status":"passed","time":{"start":1768484102011,"stop":1768484112181,"duration":10170}},{"uid":"a71d4b6504b25389","reportUrl":"https://vaizcom.github.io/autotests/538/#testresult/a71d4b6504b25389","status":"passed","time":{"start":1768474367298,"stop":1768474389416,"duration":22118}},{"uid":"811a8acd3fa32ce3","reportUrl":"https://vaizcom.github.io/autotests/537/#testresult/811a8acd3fa32ce3","status":"passed","time":{"start":1768472891929,"stop":1768472913440,"duration":21511}},{"uid":"1294a001c1310884","reportUrl":"https://vaizcom.github.io/autotests/536/#testresult/1294a001c1310884","status":"passed","time":{"start":1768469852421,"stop":1768469860874,"duration":8453}},{"uid":"68beaf7073895f4","reportUrl":"https://vaizcom.github.io/autotests/534/#testresult/68beaf7073895f4","status":"passed","time":{"start":1768468097125,"stop":1768468100995,"duration":3870}},{"uid":"9b74d6cb0511e4b4","reportUrl":"https://vaizcom.github.io/autotests/533/#testresult/9b74d6cb0511e4b4","status":"passed","time":{"start":1768403861602,"stop":1768403866169,"duration":4567}},{"uid":"7f91d79aa5ba8c99","reportUrl":"https://vaizcom.github.io/autotests/532/#testresult/7f91d79aa5ba8c99","status":"passed","time":{"start":1768317204136,"stop":1768317214761,"duration":10625}},{"uid":"5c70f03a8d357e96","reportUrl":"https://vaizcom.github.io/autotests/531/#testresult/5c70f03a8d357e96","status":"passed","time":{"start":1768299851872,"stop":1768299866514,"duration":14642}}]},"tags":["backend"]},"source":"82737a96042a3636.json","parameterValues":[]}